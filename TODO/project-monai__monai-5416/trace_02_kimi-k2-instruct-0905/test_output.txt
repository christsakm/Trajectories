+ source /opt/miniconda3/bin/activate
++ _CONDA_ROOT=/opt/miniconda3
++ . /opt/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /opt/miniconda3/bin/conda
++++ dirname /opt/miniconda3/bin
+++ PATH=/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate
+++ /opt/miniconda3/bin/conda shell.posix activate
++ ask_conda='PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ eval 'PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+++ PS1='(base) '
+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export CONDA_PREFIX=/opt/miniconda3
+++ CONDA_PREFIX=/opt/miniconda3
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ conda activate testbed
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate testbed
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate testbed
++ /opt/miniconda3/bin/conda shell.posix activate testbed
+ ask_conda='PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''2'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_1='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+ eval 'PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''2'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_1='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ PS1='(testbed) '
++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ export CONDA_SHLVL=2
++ CONDA_SHLVL=2
++ export CONDA_DEFAULT_ENV=testbed
++ CONDA_DEFAULT_ENV=testbed
++ export 'CONDA_PROMPT_MODIFIER=(testbed) '
++ CONDA_PROMPT_MODIFIER='(testbed) '
++ export CONDA_PREFIX_1=/opt/miniconda3
++ CONDA_PREFIX_1=/opt/miniconda3
++ export CONDA_EXE=/opt/miniconda3/bin/conda
++ CONDA_EXE=/opt/miniconda3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r
+ cd /testbed
+ git config --global --add safe.directory /testbed
+ cd /testbed
+ git status
On branch dev
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
	modified:   monai/losses/dice.py

no changes added to commit (use "git add" and/or "git commit -a")
+ git show
commit 8925e3eea656dd1c24c90db70449c44d8ca0f044
Author: Wenqi Li <831580+wyli@users.noreply.github.com>
Date:   Thu Oct 27 10:31:57 2022 +0100

    5414 size/size() for metatensor compatibility (#5415)
    
    Signed-off-by: Wenqi Li <wenqil@nvidia.com>
    
    Fixes #5414
    
    
    
    ### Types of changes
    <!--- Put an `x` in all the boxes that apply, and remove the not
    applicable items -->
    - [x] Non-breaking change (fix or new feature that would not break
    existing functionality).
    - [ ] Breaking change (fix or new feature that would cause existing
    functionality to change).
    - [x] New tests added to cover the changes.
    - [ ] Integration tests passed locally by running `./runtests.sh -f -u
    --net --coverage`.
    - [ ] Quick tests passed locally by running `./runtests.sh --quick
    --unittests --disttests`.
    - [ ] In-line docstrings updated.
    - [ ] Documentation updated, tested `make html` command in the `docs/`
    folder.
    
    Signed-off-by: Wenqi Li <wenqil@nvidia.com>

diff --git a/monai/transforms/utils.py b/monai/transforms/utils.py
index 3096d768..e96d906f 100644
--- a/monai/transforms/utils.py
+++ b/monai/transforms/utils.py
@@ -505,11 +505,11 @@ def generate_pos_neg_label_crop_centers(
         raise ValueError("No sampling location available.")
 
     if len(fg_indices) == 0 or len(bg_indices) == 0:
+        pos_ratio = 0 if len(fg_indices) == 0 else 1
         warnings.warn(
-            f"N foreground {len(fg_indices)}, N  background {len(bg_indices)},"
-            "unable to generate class balanced samples."
+            f"Num foregrounds {len(fg_indices)}, Num backgrounds {len(bg_indices)}, "
+            f"unable to generate class balanced samples, setting `pos_ratio` to {pos_ratio}."
         )
-        pos_ratio = 0 if fg_indices.size == 0 else 1
 
     for _ in range(num_samples):
         indices_to_use = fg_indices if rand_state.rand() < pos_ratio else bg_indices
diff --git a/tests/test_generate_pos_neg_label_crop_centers.py b/tests/test_generate_pos_neg_label_crop_centers.py
index 91db0e9d..d1a20877 100644
--- a/tests/test_generate_pos_neg_label_crop_centers.py
+++ b/tests/test_generate_pos_neg_label_crop_centers.py
@@ -31,7 +31,20 @@ TESTS = [
         list,
         2,
         3,
-    ]
+    ],
+    [
+        {
+            "spatial_size": [2, 2, 2],
+            "num_samples": 2,
+            "pos_ratio": 0.0,
+            "label_spatial_shape": [3, 3, 3],
+            "fg_indices": [],
+            "bg_indices": [3, 12, 21],
+        },
+        list,
+        2,
+        3,
+    ],
 ]
 
 
+ git diff 8925e3eea656dd1c24c90db70449c44d8ca0f044
diff --git a/monai/losses/dice.py b/monai/losses/dice.py
index 869dd05a..bbadfee9 100644
--- a/monai/losses/dice.py
+++ b/monai/losses/dice.py
@@ -130,14 +130,9 @@ class DiceLoss(_Loss):
             input = torch.sigmoid(input)
 
         n_pred_ch = input.shape[1]
-        if self.softmax:
-            if n_pred_ch == 1:
-                warnings.warn("single channel prediction, `softmax=True` ignored.")
-            else:
-                input = torch.softmax(input, 1)
-
-        if self.other_act is not None:
-            input = self.other_act(input)
+        
+        # Store original number of channels for background exclusion check
+        orig_n_pred_ch = n_pred_ch
 
         if self.to_onehot_y:
             if n_pred_ch == 1:
@@ -146,12 +141,24 @@ class DiceLoss(_Loss):
                 target = one_hot(target, num_classes=n_pred_ch)
 
         if not self.include_background:
-            if n_pred_ch == 1:
+            if orig_n_pred_ch == 1:
                 warnings.warn("single channel prediction, `include_background=False` ignored.")
             else:
                 # if skipping background, removing first channel
                 target = target[:, 1:]
                 input = input[:, 1:]
+                # Update n_pred_ch after removing background
+                n_pred_ch = input.shape[1]
+
+        # Get class probabilities from logits
+        if self.softmax:
+            if n_pred_ch == 1:
+                warnings.warn("single channel prediction, `softmax=True` ignored.")
+            else:
+                input = torch.softmax(input, 1)
+
+        if self.other_act is not None:
+            input = self.other_act(input)
 
         if target.shape != input.shape:
             raise AssertionError(f"ground truth has different shape ({target.shape}) from input ({input.shape})")
@@ -846,6 +853,14 @@ class DiceFocalLoss(_Loss):
             else:
                 target = one_hot(target, num_classes=n_pred_ch)
 
+        # Store original input for focal loss
+        focal_input = input
+        focal_target = target
+
+        # Apply softmax to input before background exclusion if dice loss expects it
+        if self.dice.softmax and n_pred_ch > 1:
+            input = torch.softmax(input, 1)
+
         if not self.include_background:
             if n_pred_ch == 1:
                 warnings.warn("single channel prediction, `include_background=False` ignored.")
@@ -854,8 +869,23 @@ class DiceFocalLoss(_Loss):
                 target = target[:, 1:]
                 input = input[:, 1:]
 
-        dice_loss = self.dice(input, target)
-        focal_loss = self.focal(input, target)
+        # Create a dice loss instance with softmax disabled since we already applied it
+        dice_loss = DiceLoss(
+            include_background=True,  # Already handled above
+            to_onehot_y=False,  # Already handled above
+            sigmoid=self.dice.sigmoid,
+            softmax=False,  # Already applied above
+            other_act=self.dice.other_act,
+            squared_pred=self.dice.squared_pred,
+            jaccard=self.dice.jaccard,
+            reduction=self.dice.reduction,
+            smooth_nr=self.dice.smooth_nr,
+            smooth_dr=self.dice.smooth_dr,
+            batch=self.dice.batch,
+        )
+        dice_loss = dice_loss(input, target)
+
+        focal_loss = self.focal(focal_input, focal_target)
         total_loss: torch.Tensor = self.lambda_dice * dice_loss + self.lambda_focal * focal_loss
         return total_loss
 
+ source /opt/miniconda3/bin/activate
++ _CONDA_ROOT=/opt/miniconda3
++ . /opt/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ '[' -z x ']'
++ conda activate
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate
++ '[' -n '' ']'
++ local ask_conda
+++ PS1='(testbed) '
+++ __conda_exe shell.posix activate
+++ /opt/miniconda3/bin/conda shell.posix activate
++ ask_conda='PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/opt/miniconda3/envs/testbed'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ eval 'PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/opt/miniconda3/envs/testbed'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+++ PS1='(base) '
+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export CONDA_PREFIX=/opt/miniconda3
+++ CONDA_PREFIX=/opt/miniconda3
+++ export CONDA_SHLVL=3
+++ CONDA_SHLVL=3
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
+++ export CONDA_PREFIX_2=/opt/miniconda3/envs/testbed
+++ CONDA_PREFIX_2=/opt/miniconda3/envs/testbed
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ conda activate testbed
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate testbed
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate testbed
++ /opt/miniconda3/bin/conda shell.posix activate testbed
+ ask_conda='PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_3='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+ eval 'PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_3='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ PS1='(testbed) '
++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ export CONDA_SHLVL=4
++ CONDA_SHLVL=4
++ export CONDA_DEFAULT_ENV=testbed
++ CONDA_DEFAULT_ENV=testbed
++ export 'CONDA_PROMPT_MODIFIER=(testbed) '
++ CONDA_PROMPT_MODIFIER='(testbed) '
++ export CONDA_PREFIX_3=/opt/miniconda3
++ CONDA_PREFIX_3=/opt/miniconda3
++ export CONDA_EXE=/opt/miniconda3/bin/conda
++ CONDA_EXE=/opt/miniconda3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r
+ sed -i '/^git+https:\/\/github.com\/Project-MONAI\//d' requirements-dev.txt
+ python -m pip install types-pkg-resources==0.1.3 pytest
Requirement already satisfied: types-pkg-resources==0.1.3 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (0.1.3)
Requirement already satisfied: pytest in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (8.3.5)
Requirement already satisfied: exceptiongroup>=1.0.0rc8 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pytest) (1.3.0)
Requirement already satisfied: iniconfig in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pytest) (2.1.0)
Requirement already satisfied: packaging in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pytest) (24.2)
Requirement already satisfied: pluggy<2,>=1.5 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pytest) (1.5.0)
Requirement already satisfied: tomli>=1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pytest) (2.3.0)
Requirement already satisfied: typing-extensions>=4.6.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from exceptiongroup>=1.0.0rc8->pytest) (4.13.2)
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
+ pip install -r requirements-dev.txt
Requirement already satisfied: torch>=1.7 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements.txt (line 1)) (1.13.1)
Requirement already satisfied: numpy>=1.17 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements.txt (line 2)) (1.24.4)
Requirement already satisfied: setuptools!=60.0.0,!=60.6.0,>=50.3.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-min.txt (line 3)) (75.1.0)
Requirement already satisfied: coverage>=5.5 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-min.txt (line 4)) (7.6.1)
Requirement already satisfied: parameterized in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-min.txt (line 5)) (0.9.0)
Requirement already satisfied: pytorch-ignite==0.4.10 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 3)) (0.4.10)
Requirement already satisfied: gdown>=4.4.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 4)) (5.2.0)
Requirement already satisfied: scipy in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 5)) (1.10.1)
Requirement already satisfied: itk>=5.2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 6)) (5.4.4)
Requirement already satisfied: nibabel in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 7)) (5.2.1)
Requirement already satisfied: pillow!=8.3.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 8)) (10.4.0)
Requirement already satisfied: tensorboard in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 9)) (2.14.0)
Requirement already satisfied: scikit-image>=0.19.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 10)) (0.21.0)
Requirement already satisfied: tqdm>=4.47.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 11)) (4.67.1)
Requirement already satisfied: lmdb in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 12)) (1.7.5)
Requirement already satisfied: flake8>=3.8.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 13)) (7.1.2)
Requirement already satisfied: flake8-bugbear in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 14)) (24.12.12)
Requirement already satisfied: flake8-comprehensions in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 15)) (3.15.0)
Requirement already satisfied: flake8-executable in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 16)) (2.1.3)
Requirement already satisfied: pylint!=2.13 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 17)) (3.2.7)
Requirement already satisfied: mccabe in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 18)) (0.7.0)
Requirement already satisfied: pep8-naming in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 19)) (0.14.1)
Requirement already satisfied: pycodestyle in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 20)) (2.12.1)
Requirement already satisfied: pyflakes in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 21)) (3.2.0)
Requirement already satisfied: black in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 22)) (24.8.0)
Requirement already satisfied: isort in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 23)) (5.13.2)
Requirement already satisfied: pytype>=2020.6.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 24)) (2024.9.13)
Requirement already satisfied: types-pkg_resources in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 25)) (0.1.3)
Requirement already satisfied: mypy>=0.790 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 26)) (1.14.1)
Requirement already satisfied: ninja in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 27)) (1.13.0)
Requirement already satisfied: torchvision in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 28)) (0.14.1)
Requirement already satisfied: psutil in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 29)) (7.1.3)
Requirement already satisfied: Sphinx==3.5.3 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 30)) (3.5.3)
Requirement already satisfied: recommonmark==0.6.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 31)) (0.6.0)
Requirement already satisfied: sphinx-autodoc-typehints==1.11.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 32)) (1.11.1)
Requirement already satisfied: sphinx-rtd-theme==0.5.2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 33)) (0.5.2)
Requirement already satisfied: cucim==22.8.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 34)) (22.8.1)
Requirement already satisfied: openslide-python==1.1.2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 35)) (1.1.2)
Requirement already satisfied: imagecodecs in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 36)) (2023.3.16)
Requirement already satisfied: tifffile in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 37)) (2023.7.10)
Requirement already satisfied: pandas in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 38)) (2.0.3)
Requirement already satisfied: requests in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 39)) (2.32.4)
Requirement already satisfied: einops in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 40)) (0.8.1)
Requirement already satisfied: transformers<4.22 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 41)) (4.21.3)
Requirement already satisfied: mlflow in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 42)) (2.17.2)
Requirement already satisfied: matplotlib!=3.5.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 43)) (3.7.5)
Requirement already satisfied: tensorboardX in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 44)) (2.6.2.2)
Requirement already satisfied: types-PyYAML in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 45)) (6.0.12.20241230)
Requirement already satisfied: pyyaml in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 46)) (6.0.3)
Requirement already satisfied: fire in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 47)) (0.7.1)
Requirement already satisfied: jsonschema in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 48)) (4.23.0)
Requirement already satisfied: pynrrd in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 49)) (1.1.3)
Requirement already satisfied: pre-commit in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 50)) (3.5.0)
Requirement already satisfied: pydicom in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 51)) (2.4.4)
Requirement already satisfied: h5py in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 52)) (3.11.0)
Requirement already satisfied: nni in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 53)) (3.0)
Requirement already satisfied: optuna in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from -r requirements-dev.txt (line 54)) (4.5.0)
Requirement already satisfied: packaging in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pytorch-ignite==0.4.10->-r requirements-dev.txt (line 3)) (24.2)
Requirement already satisfied: sphinxcontrib-applehelp in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Sphinx==3.5.3->-r requirements-dev.txt (line 30)) (1.0.4)
Requirement already satisfied: sphinxcontrib-devhelp in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Sphinx==3.5.3->-r requirements-dev.txt (line 30)) (1.0.2)
Requirement already satisfied: sphinxcontrib-jsmath in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Sphinx==3.5.3->-r requirements-dev.txt (line 30)) (1.0.1)
Requirement already satisfied: sphinxcontrib-htmlhelp in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Sphinx==3.5.3->-r requirements-dev.txt (line 30)) (2.0.1)
Requirement already satisfied: sphinxcontrib-serializinghtml in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Sphinx==3.5.3->-r requirements-dev.txt (line 30)) (1.1.5)
Requirement already satisfied: sphinxcontrib-qthelp in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Sphinx==3.5.3->-r requirements-dev.txt (line 30)) (1.0.3)
Requirement already satisfied: Jinja2>=2.3 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Sphinx==3.5.3->-r requirements-dev.txt (line 30)) (3.1.6)
Requirement already satisfied: Pygments>=2.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Sphinx==3.5.3->-r requirements-dev.txt (line 30)) (2.19.2)
Requirement already satisfied: docutils>=0.12 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Sphinx==3.5.3->-r requirements-dev.txt (line 30)) (0.16)
Requirement already satisfied: snowballstemmer>=1.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Sphinx==3.5.3->-r requirements-dev.txt (line 30)) (3.0.1)
Requirement already satisfied: babel>=1.3 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Sphinx==3.5.3->-r requirements-dev.txt (line 30)) (2.17.0)
Requirement already satisfied: alabaster<0.8,>=0.7 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Sphinx==3.5.3->-r requirements-dev.txt (line 30)) (0.7.13)
Requirement already satisfied: imagesize in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Sphinx==3.5.3->-r requirements-dev.txt (line 30)) (1.4.1)
Requirement already satisfied: commonmark>=0.8.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from recommonmark==0.6.0->-r requirements-dev.txt (line 31)) (0.9.1)
Requirement already satisfied: click in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from cucim==22.8.1->-r requirements-dev.txt (line 34)) (8.1.8)
Requirement already satisfied: typing-extensions in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from torch>=1.7->-r requirements.txt (line 1)) (4.13.2)
Requirement already satisfied: nvidia-cuda-runtime-cu11==11.7.99 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from torch>=1.7->-r requirements.txt (line 1)) (11.7.99)
Requirement already satisfied: nvidia-cudnn-cu11==8.5.0.96 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from torch>=1.7->-r requirements.txt (line 1)) (8.5.0.96)
Requirement already satisfied: nvidia-cublas-cu11==11.10.3.66 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from torch>=1.7->-r requirements.txt (line 1)) (11.10.3.66)
Requirement already satisfied: nvidia-cuda-nvrtc-cu11==11.7.99 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from torch>=1.7->-r requirements.txt (line 1)) (11.7.99)
Requirement already satisfied: wheel in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from nvidia-cublas-cu11==11.10.3.66->torch>=1.7->-r requirements.txt (line 1)) (0.44.0)
Requirement already satisfied: beautifulsoup4 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from gdown>=4.4.0->-r requirements-dev.txt (line 4)) (4.14.2)
Requirement already satisfied: filelock in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from gdown>=4.4.0->-r requirements-dev.txt (line 4)) (3.11.0)
Requirement already satisfied: itk-core==5.4.4 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from itk>=5.2->-r requirements-dev.txt (line 6)) (5.4.4)
Requirement already satisfied: itk-numerics==5.4.4 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from itk>=5.2->-r requirements-dev.txt (line 6)) (5.4.4)
Requirement already satisfied: itk-io==5.4.4 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from itk>=5.2->-r requirements-dev.txt (line 6)) (5.4.4)
Requirement already satisfied: itk-filtering==5.4.4 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from itk>=5.2->-r requirements-dev.txt (line 6)) (5.4.4)
Requirement already satisfied: itk-registration==5.4.4 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from itk>=5.2->-r requirements-dev.txt (line 6)) (5.4.4)
Requirement already satisfied: itk-segmentation==5.4.4 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from itk>=5.2->-r requirements-dev.txt (line 6)) (5.4.4)
Requirement already satisfied: importlib-resources>=1.3 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from nibabel->-r requirements-dev.txt (line 7)) (6.4.5)
Requirement already satisfied: absl-py>=0.4 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from tensorboard->-r requirements-dev.txt (line 9)) (2.3.1)
Requirement already satisfied: grpcio>=1.48.2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from tensorboard->-r requirements-dev.txt (line 9)) (1.70.0)
Requirement already satisfied: google-auth<3,>=1.6.3 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from tensorboard->-r requirements-dev.txt (line 9)) (2.43.0)
Requirement already satisfied: google-auth-oauthlib<1.1,>=0.5 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from tensorboard->-r requirements-dev.txt (line 9)) (1.0.0)
Requirement already satisfied: markdown>=2.6.8 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from tensorboard->-r requirements-dev.txt (line 9)) (3.7)
Requirement already satisfied: protobuf>=3.19.6 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from tensorboard->-r requirements-dev.txt (line 9)) (5.29.5)
Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from tensorboard->-r requirements-dev.txt (line 9)) (0.7.2)
Requirement already satisfied: werkzeug>=1.0.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from tensorboard->-r requirements-dev.txt (line 9)) (3.0.6)
Requirement already satisfied: networkx>=2.8 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from scikit-image>=0.19.0->-r requirements-dev.txt (line 10)) (3.1)
Requirement already satisfied: imageio>=2.27 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from scikit-image>=0.19.0->-r requirements-dev.txt (line 10)) (2.35.1)
Requirement already satisfied: PyWavelets>=1.1.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from scikit-image>=0.19.0->-r requirements-dev.txt (line 10)) (1.4.1)
Requirement already satisfied: lazy_loader>=0.2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from scikit-image>=0.19.0->-r requirements-dev.txt (line 10)) (0.4)
Requirement already satisfied: attrs>=22.2.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from flake8-bugbear->-r requirements-dev.txt (line 14)) (25.3.0)
Requirement already satisfied: platformdirs>=2.2.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pylint!=2.13->-r requirements-dev.txt (line 17)) (3.11.0)
Requirement already satisfied: astroid<=3.3.0-dev0,>=3.2.4 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pylint!=2.13->-r requirements-dev.txt (line 17)) (3.2.4)
Requirement already satisfied: tomlkit>=0.10.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pylint!=2.13->-r requirements-dev.txt (line 17)) (0.13.3)
Requirement already satisfied: dill>=0.2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pylint!=2.13->-r requirements-dev.txt (line 17)) (0.4.0)
Requirement already satisfied: tomli>=1.1.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pylint!=2.13->-r requirements-dev.txt (line 17)) (2.3.0)
Requirement already satisfied: mypy-extensions>=0.4.3 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from black->-r requirements-dev.txt (line 22)) (1.1.0)
Requirement already satisfied: pathspec>=0.9.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from black->-r requirements-dev.txt (line 22)) (0.12.1)
Requirement already satisfied: importlab>=0.8 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pytype>=2020.6.1->-r requirements-dev.txt (line 24)) (0.8.1)
Requirement already satisfied: immutabledict>=4.1.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pytype>=2020.6.1->-r requirements-dev.txt (line 24)) (4.2.2)
Requirement already satisfied: libcst>=1.0.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pytype>=2020.6.1->-r requirements-dev.txt (line 24)) (1.1.0)
Requirement already satisfied: msgspec>=0.18.6 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pytype>=2020.6.1->-r requirements-dev.txt (line 24)) (0.18.6)
Requirement already satisfied: pycnite>=2024.07.31 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pytype>=2020.6.1->-r requirements-dev.txt (line 24)) (2024.7.31)
Requirement already satisfied: pydot>=1.4.2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pytype>=2020.6.1->-r requirements-dev.txt (line 24)) (4.0.1)
Requirement already satisfied: tabulate>=0.8.10 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pytype>=2020.6.1->-r requirements-dev.txt (line 24)) (0.9.0)
Requirement already satisfied: toml>=0.10.2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pytype>=2020.6.1->-r requirements-dev.txt (line 24)) (0.10.2)
Requirement already satisfied: python-dateutil>=2.8.2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pandas->-r requirements-dev.txt (line 38)) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pandas->-r requirements-dev.txt (line 38)) (2025.2)
Requirement already satisfied: tzdata>=2022.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pandas->-r requirements-dev.txt (line 38)) (2025.2)
Requirement already satisfied: charset_normalizer<4,>=2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from requests->-r requirements-dev.txt (line 39)) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from requests->-r requirements-dev.txt (line 39)) (3.11)
Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from requests->-r requirements-dev.txt (line 39)) (2.2.3)
Requirement already satisfied: certifi>=2017.4.17 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from requests->-r requirements-dev.txt (line 39)) (2025.11.12)
Requirement already satisfied: huggingface-hub<1.0,>=0.1.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from transformers<4.22->-r requirements-dev.txt (line 41)) (0.36.0)
Requirement already satisfied: regex!=2019.12.17 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from transformers<4.22->-r requirements-dev.txt (line 41)) (2024.11.6)
Requirement already satisfied: tokenizers!=0.11.3,<0.13,>=0.11.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from transformers<4.22->-r requirements-dev.txt (line 41)) (0.12.1)
Requirement already satisfied: mlflow-skinny==2.17.2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow->-r requirements-dev.txt (line 42)) (2.17.2)
Requirement already satisfied: Flask<4 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow->-r requirements-dev.txt (line 42)) (3.0.3)
Requirement already satisfied: alembic!=1.10.0,<2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow->-r requirements-dev.txt (line 42)) (1.14.1)
Requirement already satisfied: docker<8,>=4.0.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow->-r requirements-dev.txt (line 42)) (7.1.0)
Requirement already satisfied: graphene<4 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow->-r requirements-dev.txt (line 42)) (3.4.3)
Requirement already satisfied: pyarrow<18,>=4.0.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow->-r requirements-dev.txt (line 42)) (17.0.0)
Requirement already satisfied: scikit-learn<2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow->-r requirements-dev.txt (line 42)) (1.3.2)
Requirement already satisfied: sqlalchemy<3,>=1.4.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow->-r requirements-dev.txt (line 42)) (2.0.44)
Requirement already satisfied: gunicorn<24 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow->-r requirements-dev.txt (line 42)) (23.0.0)
Requirement already satisfied: cachetools<6,>=5.0.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow-skinny==2.17.2->mlflow->-r requirements-dev.txt (line 42)) (5.5.2)
Requirement already satisfied: cloudpickle<4 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow-skinny==2.17.2->mlflow->-r requirements-dev.txt (line 42)) (3.1.2)
Requirement already satisfied: databricks-sdk<1,>=0.20.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow-skinny==2.17.2->mlflow->-r requirements-dev.txt (line 42)) (0.73.0)
Requirement already satisfied: gitpython<4,>=3.1.9 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow-skinny==2.17.2->mlflow->-r requirements-dev.txt (line 42)) (3.1.45)
Requirement already satisfied: importlib-metadata!=4.7.0,<9,>=3.7.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow-skinny==2.17.2->mlflow->-r requirements-dev.txt (line 42)) (8.5.0)
Requirement already satisfied: opentelemetry-api<3,>=1.9.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow-skinny==2.17.2->mlflow->-r requirements-dev.txt (line 42)) (1.33.1)
Requirement already satisfied: opentelemetry-sdk<3,>=1.9.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow-skinny==2.17.2->mlflow->-r requirements-dev.txt (line 42)) (1.33.1)
Requirement already satisfied: sqlparse<1,>=0.4.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from mlflow-skinny==2.17.2->mlflow->-r requirements-dev.txt (line 42)) (0.5.3)
Requirement already satisfied: contourpy>=1.0.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from matplotlib!=3.5.0->-r requirements-dev.txt (line 43)) (1.1.1)
Requirement already satisfied: cycler>=0.10 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from matplotlib!=3.5.0->-r requirements-dev.txt (line 43)) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from matplotlib!=3.5.0->-r requirements-dev.txt (line 43)) (4.57.0)
Requirement already satisfied: kiwisolver>=1.0.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from matplotlib!=3.5.0->-r requirements-dev.txt (line 43)) (1.4.7)
Requirement already satisfied: pyparsing>=2.3.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from matplotlib!=3.5.0->-r requirements-dev.txt (line 43)) (3.1.4)
Requirement already satisfied: termcolor in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from fire->-r requirements-dev.txt (line 47)) (2.4.0)
Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from jsonschema->-r requirements-dev.txt (line 48)) (2023.12.1)
Requirement already satisfied: pkgutil-resolve-name>=1.3.10 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from jsonschema->-r requirements-dev.txt (line 48)) (1.3.10)
Requirement already satisfied: referencing>=0.28.4 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from jsonschema->-r requirements-dev.txt (line 48)) (0.35.1)
Requirement already satisfied: rpds-py>=0.7.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from jsonschema->-r requirements-dev.txt (line 48)) (0.20.1)
Requirement already satisfied: cfgv>=2.0.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pre-commit->-r requirements-dev.txt (line 50)) (3.4.0)
Requirement already satisfied: identify>=1.0.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pre-commit->-r requirements-dev.txt (line 50)) (2.6.1)
Requirement already satisfied: nodeenv>=0.11.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pre-commit->-r requirements-dev.txt (line 50)) (1.9.1)
Requirement already satisfied: virtualenv>=20.10.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pre-commit->-r requirements-dev.txt (line 50)) (20.23.0)
Requirement already satisfied: astor in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from nni->-r requirements-dev.txt (line 53)) (0.8.1)
Requirement already satisfied: colorama in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from nni->-r requirements-dev.txt (line 53)) (0.4.6)
Requirement already satisfied: json-tricks>=3.15.5 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from nni->-r requirements-dev.txt (line 53)) (3.17.3)
Requirement already satisfied: nvidia-ml-py in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from nni->-r requirements-dev.txt (line 53)) (13.580.82)
Requirement already satisfied: prettytable in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from nni->-r requirements-dev.txt (line 53)) (3.11.0)
Requirement already satisfied: PythonWebHDFS in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from nni->-r requirements-dev.txt (line 53)) (0.2.3)
Requirement already satisfied: responses in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from nni->-r requirements-dev.txt (line 53)) (0.25.8)
Requirement already satisfied: schema in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from nni->-r requirements-dev.txt (line 53)) (0.7.8)
Requirement already satisfied: typeguard<4.1.3,>=3.0.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from nni->-r requirements-dev.txt (line 53)) (4.1.2)
Requirement already satisfied: websockets>=10.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from nni->-r requirements-dev.txt (line 53)) (13.1)
Requirement already satisfied: colorlog in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from optuna->-r requirements-dev.txt (line 54)) (6.10.1)
Requirement already satisfied: Mako in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from alembic!=1.10.0,<2->mlflow->-r requirements-dev.txt (line 42)) (1.3.10)
Requirement already satisfied: itsdangerous>=2.1.2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Flask<4->mlflow->-r requirements-dev.txt (line 42)) (2.2.0)
Requirement already satisfied: blinker>=1.6.2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Flask<4->mlflow->-r requirements-dev.txt (line 42)) (1.8.2)
Requirement already satisfied: pyasn1-modules>=0.2.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard->-r requirements-dev.txt (line 9)) (0.4.2)
Requirement already satisfied: rsa<5,>=3.1.4 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from google-auth<3,>=1.6.3->tensorboard->-r requirements-dev.txt (line 9)) (4.9.1)
Requirement already satisfied: requests-oauthlib>=0.7.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from google-auth-oauthlib<1.1,>=0.5->tensorboard->-r requirements-dev.txt (line 9)) (2.0.0)
Requirement already satisfied: graphql-core<3.3,>=3.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from graphene<4->mlflow->-r requirements-dev.txt (line 42)) (3.2.7)
Requirement already satisfied: graphql-relay<3.3,>=3.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from graphene<4->mlflow->-r requirements-dev.txt (line 42)) (3.2.0)
Requirement already satisfied: fsspec>=2023.5.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from huggingface-hub<1.0,>=0.1.0->transformers<4.22->-r requirements-dev.txt (line 41)) (2025.3.0)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.3 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from huggingface-hub<1.0,>=0.1.0->transformers<4.22->-r requirements-dev.txt (line 41)) (1.2.0)
Requirement already satisfied: zipp>=3.1.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from importlib-resources>=1.3->nibabel->-r requirements-dev.txt (line 7)) (3.20.2)
Requirement already satisfied: MarkupSafe>=2.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from Jinja2>=2.3->Sphinx==3.5.3->-r requirements-dev.txt (line 30)) (2.1.5)
Requirement already satisfied: typing-inspect>=0.4.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from libcst>=1.0.1->pytype>=2020.6.1->-r requirements-dev.txt (line 24)) (0.9.0)
Requirement already satisfied: six>=1.5 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from python-dateutil>=2.8.2->pandas->-r requirements-dev.txt (line 38)) (1.17.0)
Requirement already satisfied: joblib>=1.1.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from scikit-learn<2->mlflow->-r requirements-dev.txt (line 42)) (1.4.2)
Requirement already satisfied: threadpoolctl>=2.0.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from scikit-learn<2->mlflow->-r requirements-dev.txt (line 42)) (3.5.0)
Requirement already satisfied: greenlet>=1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from sqlalchemy<3,>=1.4.0->mlflow->-r requirements-dev.txt (line 42)) (3.1.1)
Requirement already satisfied: distlib<1,>=0.3.6 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from virtualenv>=20.10.0->pre-commit->-r requirements-dev.txt (line 50)) (0.4.0)
Requirement already satisfied: soupsieve>1.2 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from beautifulsoup4->gdown>=4.4.0->-r requirements-dev.txt (line 4)) (2.7)
Requirement already satisfied: wcwidth in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from prettytable->nni->-r requirements-dev.txt (line 53)) (0.2.14)
Requirement already satisfied: simplejson in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from PythonWebHDFS->nni->-r requirements-dev.txt (line 53)) (3.20.2)
Requirement already satisfied: PySocks!=1.5.7,>=1.5.6 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from requests[socks]->gdown>=4.4.0->-r requirements-dev.txt (line 4)) (1.7.1)
Requirement already satisfied: gitdb<5,>=4.0.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from gitpython<4,>=3.1.9->mlflow-skinny==2.17.2->mlflow->-r requirements-dev.txt (line 42)) (4.0.12)
Requirement already satisfied: deprecated>=1.2.6 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from opentelemetry-api<3,>=1.9.0->mlflow-skinny==2.17.2->mlflow->-r requirements-dev.txt (line 42)) (1.3.1)
Requirement already satisfied: opentelemetry-semantic-conventions==0.54b1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from opentelemetry-sdk<3,>=1.9.0->mlflow-skinny==2.17.2->mlflow->-r requirements-dev.txt (line 42)) (0.54b1)
Requirement already satisfied: pyasn1<0.7.0,>=0.6.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard->-r requirements-dev.txt (line 9)) (0.6.1)
Requirement already satisfied: oauthlib>=3.0.0 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<1.1,>=0.5->tensorboard->-r requirements-dev.txt (line 9)) (3.3.1)
Requirement already satisfied: wrapt<3,>=1.10 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from deprecated>=1.2.6->opentelemetry-api<3,>=1.9.0->mlflow-skinny==2.17.2->mlflow->-r requirements-dev.txt (line 42)) (2.0.1)
Requirement already satisfied: smmap<6,>=3.0.1 in /opt/miniconda3/envs/testbed/lib/python3.8/site-packages (from gitdb<5,>=4.0.1->gitpython<4,>=3.1.9->mlflow-skinny==2.17.2->mlflow->-r requirements-dev.txt (line 42)) (5.0.2)
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
+ python setup.py develop
setup.py with torch 1.13.1+cu117
Please set environment variable `BUILD_MONAI=1` to enable Cpp/CUDA extension build.
BUILD_MONAI_CPP=False, BUILD_MONAI_CUDA=False, TORCH_VERSION=11301.
running develop
running egg_info
writing monai.egg-info/PKG-INFO
writing dependency_links to monai.egg-info/dependency_links.txt
writing requirements to monai.egg-info/requires.txt
writing top-level names to monai.egg-info/top_level.txt
reading manifest file 'monai.egg-info/SOURCES.txt'
reading manifest template 'MANIFEST.in'
adding license file 'LICENSE'
writing manifest file 'monai.egg-info/SOURCES.txt'
running build_ext
Creating /opt/miniconda3/envs/testbed/lib/python3.8/site-packages/monai.egg-link (link to .)
monai 1.0.0+70.g8925e3ee.dirty is already the active version in easy-install.pth

Installed /testbed
Processing dependencies for monai==1.0.0+70.g8925e3ee.dirty
Searching for numpy==1.24.4
Best match: numpy 1.24.4
Adding numpy 1.24.4 to easy-install.pth file
Installing f2py script to /opt/miniconda3/envs/testbed/bin
Installing f2py3 script to /opt/miniconda3/envs/testbed/bin
Installing f2py3.8 script to /opt/miniconda3/envs/testbed/bin

Using /opt/miniconda3/envs/testbed/lib/python3.8/site-packages
Searching for torch==1.13.1
Best match: torch 1.13.1
Adding torch 1.13.1 to easy-install.pth file
Installing convert-caffe2-to-onnx script to /opt/miniconda3/envs/testbed/bin
Installing convert-onnx-to-caffe2 script to /opt/miniconda3/envs/testbed/bin
Installing torchrun script to /opt/miniconda3/envs/testbed/bin

Using /opt/miniconda3/envs/testbed/lib/python3.8/site-packages
Searching for nvidia-cuda-nvrtc-cu11==11.7.99
Best match: nvidia-cuda-nvrtc-cu11 11.7.99
Adding nvidia-cuda-nvrtc-cu11 11.7.99 to easy-install.pth file

Using /opt/miniconda3/envs/testbed/lib/python3.8/site-packages
Searching for nvidia-cublas-cu11==11.10.3.66
Best match: nvidia-cublas-cu11 11.10.3.66
Adding nvidia-cublas-cu11 11.10.3.66 to easy-install.pth file

Using /opt/miniconda3/envs/testbed/lib/python3.8/site-packages
Searching for nvidia-cudnn-cu11==8.5.0.96
Best match: nvidia-cudnn-cu11 8.5.0.96
Adding nvidia-cudnn-cu11 8.5.0.96 to easy-install.pth file

Using /opt/miniconda3/envs/testbed/lib/python3.8/site-packages
Searching for nvidia-cuda-runtime-cu11==11.7.99
Best match: nvidia-cuda-runtime-cu11 11.7.99
Adding nvidia-cuda-runtime-cu11 11.7.99 to easy-install.pth file

Using /opt/miniconda3/envs/testbed/lib/python3.8/site-packages
Searching for typing-extensions==4.13.2
Best match: typing-extensions 4.13.2
Adding typing-extensions 4.13.2 to easy-install.pth file

Using /opt/miniconda3/envs/testbed/lib/python3.8/site-packages
Searching for wheel==0.44.0
Best match: wheel 0.44.0
Adding wheel 0.44.0 to easy-install.pth file
Installing wheel script to /opt/miniconda3/envs/testbed/bin

Using /opt/miniconda3/envs/testbed/lib/python3.8/site-packages
Searching for setuptools==75.1.0
Best match: setuptools 75.1.0
Adding setuptools 75.1.0 to easy-install.pth file

Using /opt/miniconda3/envs/testbed/lib/python3.8/site-packages
Finished processing dependencies for monai==1.0.0+70.g8925e3ee.dirty
setup.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  import pkg_resources
/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/setuptools/__init__.py:94: _DeprecatedInstaller: setuptools.installer and fetch_build_eggs are deprecated.
!!

        ********************************************************************************
        Requirements should be satisfied by a PEP 517 installer.
        If you are using pip, you can try `pip install --use-pep517`.
        ********************************************************************************

!!
  dist.fetch_build_eggs(dist.setup_requires)
/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/setuptools/command/develop.py:41: EasyInstallDeprecationWarning: easy_install command is deprecated.
!!

        ********************************************************************************
        Please avoid running ``setup.py`` and ``easy_install``.
        Instead, use pypa/build, pypa/installer or other
        standards-based tools.

        See https://github.com/pypa/setuptools/issues/917 for details.
        ********************************************************************************

!!
  easy_install.initialize_options(self)
/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/setuptools/_distutils/cmd.py:66: SetuptoolsDeprecationWarning: setup.py install is deprecated.
!!

        ********************************************************************************
        Please avoid running ``setup.py`` directly.
        Instead, use pypa/build, pypa/installer or other
        standards-based tools.

        See https://blog.ganssle.io/articles/2021/10/setup-py-deprecated.html for details.
        ********************************************************************************

!!
  self.initialize_options()
+ git checkout 8925e3eea656dd1c24c90db70449c44d8ca0f044 tests/test_dice_focal_loss.py
Updated 0 paths from 90661c4d
+ git apply -v -
Checking patch tests/test_dice_focal_loss.py...
Applied patch tests/test_dice_focal_loss.py cleanly.
+ pytest -rA tests/test_dice_focal_loss.py
============================= test session starts ==============================
platform linux -- Python 3.8.20, pytest-8.3.5, pluggy-1.5.0
rootdir: /testbed
configfile: pyproject.toml
plugins: typeguard-4.1.2
collected 7 items

tests/test_dice_focal_loss.py E..FF.F                                    [100%]

==================================== ERRORS ====================================
______________________ ERROR at setup of test_script_save ______________________
file /testbed/tests/utils.py, line 690
  def test_script_save(net, *inputs, device=None, rtol=1e-4, atol=0.0):
E       fixture 'net' not found
>       available fixtures: cache, capfd, capfdbinary, caplog, capsys, capsysbinary, doctest_namespace, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory
>       use 'pytest --fixtures [testpath]' for help on them.

/testbed/tests/utils.py:690
=================================== FAILURES ===================================
_______________ TestDiceFocalLoss.test_result_no_onehot_no_bg_0 ________________

a = (<tests.test_dice_focal_loss.TestDiceFocalLoss testMethod=test_result_no_onehot_no_bg_0>,)
kw = {}

    @wraps(func)
    def standalone_func(*a, **kw):
>       return func(*(a + p.args), **p.kwargs, **kw)

/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/parameterized/parameterized.py:620: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/test_dice_focal_loss.py:59: in test_result_no_onehot_no_bg
    result = dice_focal(pred, label)
/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/torch/nn/modules/module.py:1194: in _call_impl
    return forward_call(*input, **kwargs)
monai/losses/dice.py:888: in forward
    focal_loss = self.focal(focal_input, focal_target)
/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/torch/nn/modules/module.py:1194: in _call_impl
    return forward_call(*input, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = FocalLoss()
input = tensor([[[[-0.1589, -0.8319, -0.0538, -0.2859,  1.4671],
          [ 0.6068, -0.2246,  1.0289,  0.7589, -0.6808],
    ...],
          [ 0.2440,  0.3766, -0.4148, -2.0576, -1.6353],
          [ 0.5102, -0.0900,  0.5187,  0.8174, -1.2392]]]])
target = tensor([[[[1., 1., 1., 0., 0.],
          [0., 0., 1., 1., 1.],
          [0., 0., 1., 1., 0.],
          [0., 0., 1.,...0., 0., 0., 0., 1.],
          [0., 0., 1., 0., 0.],
          [0., 0., 0., 0., 0.],
          [0., 0., 0., 0., 1.]]]])

    def forward(self, input: torch.Tensor, target: torch.Tensor) -> torch.Tensor:
        """
        Args:
            input: the shape should be BNH[WD], where N is the number of classes.
                The input should be the original logits since it will be transformed by
                a sigmoid in the forward function.
            target: the shape should be BNH[WD] or B1H[WD], where N is the number of classes.
    
        Raises:
            ValueError: When input and target (after one hot transform if set)
                have different shapes.
            ValueError: When ``self.reduction`` is not one of ["mean", "sum", "none"].
            ValueError: When ``self.weight`` is a sequence and the length is not equal to the
                number of classes.
            ValueError: When ``self.weight`` is/contains a value that is less than 0.
    
        """
        n_pred_ch = input.shape[1]
    
        if self.to_onehot_y:
            if n_pred_ch == 1:
                warnings.warn("single channel prediction, `to_onehot_y=True` ignored.")
            else:
                target = one_hot(target, num_classes=n_pred_ch)
    
        if not self.include_background:
            if n_pred_ch == 1:
                warnings.warn("single channel prediction, `include_background=False` ignored.")
            else:
                # if skipping background, removing first channel
                target = target[:, 1:]
                input = input[:, 1:]
    
        if target.shape != input.shape:
            raise ValueError(f"ground truth has different shape ({target.shape}) from input ({input.shape})")
    
        i = input
        t = target
    
        # Change the shape of input and target to B x N x num_voxels.
        b, n = t.shape[:2]
        i = i.reshape(b, n, -1)
        t = t.reshape(b, n, -1)
    
        # computing binary cross entropy with logits
        # see also https://github.com/pytorch/pytorch/blob/v1.9.0/aten/src/ATen/native/Loss.cpp#L231
        max_val = (-i).clamp(min=0)
        ce = i - i * t + max_val + ((-max_val).exp() + (-i - max_val).exp()).log()
    
        if self.weight is not None:
            class_weight: Optional[torch.Tensor] = None
            if isinstance(self.weight, (float, int)):
                class_weight = torch.as_tensor([self.weight] * i.size(1))
            else:
                class_weight = torch.as_tensor(self.weight)
                if class_weight.size(0) != i.size(1):
>                   raise ValueError(
                        "the length of the weight sequence should be the same as the number of classes. "
                        + "If `include_background=False`, the number should not include class 0."
                    )
E                   ValueError: the length of the weight sequence should be the same as the number of classes. If `include_background=False`, the number should not include class 0.

monai/losses/focal_loss.py:161: ValueError
_______________ TestDiceFocalLoss.test_result_no_onehot_no_bg_1 ________________

a = (<tests.test_dice_focal_loss.TestDiceFocalLoss testMethod=test_result_no_onehot_no_bg_1>,)
kw = {}

    @wraps(func)
    def standalone_func(*a, **kw):
>       return func(*(a + p.args), **p.kwargs, **kw)

/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/parameterized/parameterized.py:620: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/test_dice_focal_loss.py:61: in test_result_no_onehot_no_bg
    np.testing.assert_allclose(result, expected_val)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (<function assert_allclose.<locals>.compare at 0x7f5ab1f9db80>, array(5.0122933, dtype=float32), array(3.9921608, dtype=float32))
kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}

    @wraps(func)
    def inner(*args, **kwds):
        with self._recreate_cm():
>           return func(*args, **kwds)
E           AssertionError: 
E           Not equal to tolerance rtol=1e-07, atol=0
E           
E           Mismatched elements: 1 / 1 (100%)
E           Max absolute difference: 1.0201325
E           Max relative difference: 0.25553393
E            x: array(5.012293, dtype=float32)
E            y: array(3.992161, dtype=float32)

/opt/miniconda3/envs/testbed/lib/python3.8/contextlib.py:75: AssertionError
________________________ TestDiceFocalLoss.test_script _________________________

self = <tests.test_dice_focal_loss.TestDiceFocalLoss testMethod=test_script>

    def test_script(self):
        loss = DiceFocalLoss()
        test_input = torch.ones(2, 1, 8, 8)
>       test_script_save(loss, test_input, test_input)

tests/test_dice_focal_loss.py:75: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/utils.py:701: in test_script_save
    convert_to_torchscript(
monai/networks/utils.py:593: in convert_to_torchscript
    script_module = torch.jit.script(model, **kwargs)
/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/torch/jit/_script.py:1286: in script
    return torch.jit._recursive.create_script_module(
/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/torch/jit/_recursive.py:476: in create_script_module
    return create_script_module_impl(nn_module, concrete_type, stubs_fn)
/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/torch/jit/_recursive.py:542: in create_script_module_impl
    create_methods_and_properties_from_stubs(concrete_type, method_stubs, property_stubs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

concrete_type = <torch.ConcreteModuleType object at 0x7f5ab2d96d70>
method_stubs = [ScriptMethodStub(resolution_callback=<function createResolutionCallbackFromEnv.<locals>.<lambda> at 0x7f5ab20c01f0>, ... original_method=<bound method DiceFocalLoss.forward of DiceFocalLoss(
  (dice): DiceLoss()
  (focal): FocalLoss()
)>)]
property_stubs = []

    def create_methods_and_properties_from_stubs(concrete_type, method_stubs, property_stubs):
        method_defs = [m.def_ for m in method_stubs]
        method_rcbs = [m.resolution_callback for m in method_stubs]
        method_defaults = [get_default_args(m.original_method) for m in method_stubs]
    
        property_defs = [p.def_ for p in property_stubs]
        property_rcbs = [p.resolution_callback for p in property_stubs]
    
>       concrete_type._create_methods_and_properties(property_defs, property_rcbs, method_defs, method_rcbs, method_defaults)
E       RuntimeError: 
E       Class DiceLoss does not have an __init__ function defined:
E         File "/testbed/monai/losses/dice.py", line 873
E           
E               # Create a dice loss instance with softmax disabled since we already applied it
E               dice_loss = DiceLoss(
E                           ~~~~~~~~ <--- HERE
E                   include_background=True,  # Already handled above
E                   to_onehot_y=False,  # Already handled above

/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/torch/jit/_recursive.py:393: RuntimeError
=============================== warnings summary ===============================
monai/utils/module.py:367
  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html

../opt/miniconda3/envs/testbed/lib/python3.8/site-packages/pkg_resources/__init__.py:3154
  Deprecated call to `pkg_resources.declare_namespace('mpl_toolkits')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages

../opt/miniconda3/envs/testbed/lib/python3.8/site-packages/pkg_resources/__init__.py:3154
../opt/miniconda3/envs/testbed/lib/python3.8/site-packages/pkg_resources/__init__.py:3154
../opt/miniconda3/envs/testbed/lib/python3.8/site-packages/pkg_resources/__init__.py:3154
../opt/miniconda3/envs/testbed/lib/python3.8/site-packages/pkg_resources/__init__.py:3154
  Deprecated call to `pkg_resources.declare_namespace('sphinxcontrib')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages

../opt/miniconda3/envs/testbed/lib/python3.8/site-packages/itk/support/types.py:143
../opt/miniconda3/envs/testbed/lib/python3.8/site-packages/itk/support/types.py:143
../opt/miniconda3/envs/testbed/lib/python3.8/site-packages/itk/support/types.py:143
../opt/miniconda3/envs/testbed/lib/python3.8/site-packages/itk/support/types.py:143
  In the future `np.bool` will be defined as the corresponding NumPy scalar.

monai/utils/module.py:374
  Please use `shift` from the `scipy.ndimage` namespace, the `scipy.ndimage.interpolation` namespace is deprecated.

monai/utils/module.py:374
  Please use `binary_erosion` from the `scipy.ndimage` namespace, the `scipy.ndimage.morphology` namespace is deprecated.

monai/utils/module.py:374
  Please use `distance_transform_edt` from the `scipy.ndimage` namespace, the `scipy.ndimage.morphology` namespace is deprecated.

monai/utils/module.py:374
monai/utils/module.py:374
monai/utils/module.py:374
monai/utils/module.py:374
monai/utils/module.py:374
  Please use `distance_transform_cdt` from the `scipy.ndimage` namespace, the `scipy.ndimage.morphology` namespace is deprecated.

../opt/miniconda3/envs/testbed/lib/python3.8/site-packages/torch/utils/tensorboard/__init__.py:4
../opt/miniconda3/envs/testbed/lib/python3.8/site-packages/torch/utils/tensorboard/__init__.py:6
  distutils Version classes are deprecated. Use packaging.version instead.

tests/test_dice_focal_loss.py::TestDiceFocalLoss::test_result_no_onehot_no_bg_1
  single channel prediction, `softmax=True` ignored.

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
==================================== PASSES ====================================
=========================== short test summary info ============================
PASSED tests/test_dice_focal_loss.py::TestDiceFocalLoss::test_ill_lambda
PASSED tests/test_dice_focal_loss.py::TestDiceFocalLoss::test_ill_shape
PASSED tests/test_dice_focal_loss.py::TestDiceFocalLoss::test_result_onehot_target_include_bg
ERROR tests/test_dice_focal_loss.py::test_script_save
FAILED tests/test_dice_focal_loss.py::TestDiceFocalLoss::test_result_no_onehot_no_bg_0
FAILED tests/test_dice_focal_loss.py::TestDiceFocalLoss::test_result_no_onehot_no_bg_1
FAILED tests/test_dice_focal_loss.py::TestDiceFocalLoss::test_script - Runtim...
============== 3 failed, 3 passed, 21 warnings, 1 error in 4.51s ===============
+ git checkout 8925e3eea656dd1c24c90db70449c44d8ca0f044 tests/test_dice_focal_loss.py
Updated 1 path from 90661c4d
