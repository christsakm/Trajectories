+ source /opt/miniconda3/bin/activate
++ _CONDA_ROOT=/opt/miniconda3
++ . /opt/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /opt/miniconda3/bin/conda
++++ dirname /opt/miniconda3/bin
+++ PATH=/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate
+++ /opt/miniconda3/bin/conda shell.posix activate
++ ask_conda='PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ eval 'PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+++ PS1='(base) '
+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export CONDA_PREFIX=/opt/miniconda3
+++ CONDA_PREFIX=/opt/miniconda3
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ conda activate testbed
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate testbed
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate testbed
++ /opt/miniconda3/bin/conda shell.posix activate testbed
+ ask_conda='PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''2'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_1='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\''
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libglib_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh"'
+ eval 'PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''2'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_1='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\''
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libglib_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh"'
++ PS1='(testbed) '
++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ export CONDA_SHLVL=2
++ CONDA_SHLVL=2
++ export CONDA_DEFAULT_ENV=testbed
++ CONDA_DEFAULT_ENV=testbed
++ export 'CONDA_PROMPT_MODIFIER=(testbed) '
++ CONDA_PROMPT_MODIFIER='(testbed) '
++ export CONDA_PREFIX_1=/opt/miniconda3
++ CONDA_PREFIX_1=/opt/miniconda3
++ export CONDA_EXE=/opt/miniconda3/bin/conda
++ CONDA_EXE=/opt/miniconda3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/libglib_activate.sh
+++ export GSETTINGS_SCHEMA_DIR_CONDA_BACKUP=
+++ GSETTINGS_SCHEMA_DIR_CONDA_BACKUP=
+++ export GSETTINGS_SCHEMA_DIR=/opt/miniconda3/envs/testbed/share/glib-2.0/schemas
+++ GSETTINGS_SCHEMA_DIR=/opt/miniconda3/envs/testbed/share/glib-2.0/schemas
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh
+++ test -n ''
+++ xml_catalog_files_libxml2=
+++ XML_CATALOG_FILES=
+++ conda_catalog_files=
+++ ifs_libxml2=' 	
'
+++ IFS=' '
+++ rem=/opt/miniconda3/envs/testbed
+++ for pre in ${rem}
+++ test '' = /opt/miniconda3/envs/testbed
+++ conda_catalog_files=/opt/miniconda3/envs/testbed
+++ rem=
+++ IFS=' 	
'
+++ conda_catalog_files='file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ export 'XML_CATALOG_FILES=file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ XML_CATALOG_FILES='file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ unset conda_catalog_files ifs_libxml2 rem
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r
+ cd /testbed
+ git config --global --add safe.directory /testbed
+ cd /testbed
+ git status
On branch main
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
	modified:   dask/dataframe/io/csv.py
	modified:   dask/dataframe/io/tests/test_csv.py

no changes added to commit (use "git add" and/or "git commit -a")
+ git show
commit 554ca8877d36d30732712698f3135e13edd6654a
Author: David Katz <41651296+DavidKatz-il@users.noreply.github.com>
Date:   Tue Nov 10 15:46:22 2020 +0200

    Fix #6775 (#6809)
    
    * fix #6775
    
    * add test

diff --git a/dask/dataframe/core.py b/dask/dataframe/core.py
index 960d160ec..726ffbc84 100644
--- a/dask/dataframe/core.py
+++ b/dask/dataframe/core.py
@@ -4141,6 +4141,8 @@ class DataFrame(_Frame):
         npartitions=None,
         shuffle=None,
     ):
+        if is_series_like(other) and hasattr(other, "name"):
+            other = other.to_frame()
 
         if not is_dataframe_like(other):
             raise ValueError("other must be DataFrame")
diff --git a/dask/dataframe/tests/test_dataframe.py b/dask/dataframe/tests/test_dataframe.py
index 6529263d9..cb0b1fbd0 100644
--- a/dask/dataframe/tests/test_dataframe.py
+++ b/dask/dataframe/tests/test_dataframe.py
@@ -4463,3 +4463,11 @@ def test_attrs_series_in_dataframes():
     # when creating the _meta dataframe in make_meta_pandas(x, index=None).
     # Should start xpassing when df.iloc works. Remove the xfail then.
     assert df.A.attrs == ddf.A.attrs
+
+
+def test_join_series():
+    df = pd.DataFrame({"x": [1, 2, 3, 4, 5, 6, 7, 8]})
+    ddf = dd.from_pandas(df, npartitions=1)
+    expected_df = dd.from_pandas(df.join(df["x"], lsuffix="_"), npartitions=1)
+    actual_df = ddf.join(ddf["x"], lsuffix="_")
+    assert_eq(actual_df, expected_df)
+ git diff 554ca8877d36d30732712698f3135e13edd6654a
diff --git a/dask/dataframe/io/csv.py b/dask/dataframe/io/csv.py
index 6b34c09fb..80972b22e 100644
--- a/dask/dataframe/io/csv.py
+++ b/dask/dataframe/io/csv.py
@@ -318,6 +318,7 @@ def text_blocks_to_pandas(
     enforce=False,
     specified_dtypes=None,
     path=None,
+    blocksize=None,
 ):
     """Convert blocks of bytes to a dask.dataframe
 
@@ -380,7 +381,7 @@ def text_blocks_to_pandas(
     # Create mask of first blocks from nested block_lists
     is_first = tuple(block_mask(block_lists))
 
-    name = "read-csv-" + tokenize(reader, columns, enforce, head)
+    name = "read-csv-" + tokenize(reader, columns, enforce, head, blocksize)
 
     if path:
         block_file_names = [basename(b[1].path) for b in blocks]
@@ -604,6 +605,7 @@ def read_pandas(
         enforce=enforce,
         specified_dtypes=specified_dtypes,
         path=path,
+        blocksize=blocksize,
     )
 
 
diff --git a/dask/dataframe/io/tests/test_csv.py b/dask/dataframe/io/tests/test_csv.py
index 75045e51e..ffccf838c 100644
--- a/dask/dataframe/io/tests/test_csv.py
+++ b/dask/dataframe/io/tests/test_csv.py
@@ -182,11 +182,11 @@ def test_text_blocks_to_pandas_simple(reader, files):
     head = pandas_read_text(reader, files["2014-01-01.csv"], b"", {})
     header = files["2014-01-01.csv"].split(b"\n")[0] + b"\n"
 
-    df = text_blocks_to_pandas(reader, blocks, header, head, kwargs)
+    df = text_blocks_to_pandas(reader, blocks, header, head, kwargs, blocksize=None)
     assert isinstance(df, dd.DataFrame)
     assert list(df.columns) == ["name", "amount", "id"]
 
-    values = text_blocks_to_pandas(reader, blocks, header, head, kwargs)
+    values = text_blocks_to_pandas(reader, blocks, header, head, kwargs, blocksize=None)
     assert isinstance(values, dd.DataFrame)
     assert hasattr(values, "dask")
     assert len(values.dask) == 3
@@ -202,7 +202,7 @@ def test_text_blocks_to_pandas_kwargs(reader, files):
     head = pandas_read_text(reader, files["2014-01-01.csv"], b"", kwargs)
     header = files["2014-01-01.csv"].split(b"\n")[0] + b"\n"
 
-    df = text_blocks_to_pandas(reader, blocks, header, head, kwargs)
+    df = text_blocks_to_pandas(reader, blocks, header, head, kwargs, blocksize=None)
     assert list(df.columns) == ["name", "id"]
     result = df.compute()
     assert (result.columns == df.columns).all()
@@ -217,7 +217,7 @@ def test_text_blocks_to_pandas_blocked(reader, files):
         lines = b.split(b"\n")
         blocks.append([b"\n".join(bs) for bs in partition_all(2, lines)])
 
-    df = text_blocks_to_pandas(reader, blocks, header, expected.head(), {})
+    df = text_blocks_to_pandas(reader, blocks, header, expected.head(), {}, blocksize=None)
     assert_eq(
         df.compute().reset_index(drop=True),
         expected.reset_index(drop=True),
@@ -226,7 +226,7 @@ def test_text_blocks_to_pandas_blocked(reader, files):
 
     expected2 = expected[["name", "id"]]
     df = text_blocks_to_pandas(
-        reader, blocks, header, expected2.head(), {"usecols": ["name", "id"]}
+        reader, blocks, header, expected2.head(), {"usecols": ["name", "id"]}, blocksize=None
     )
     assert_eq(
         df.compute().reset_index(drop=True),
@@ -287,7 +287,7 @@ tsv_blocks = [
 def test_enforce_dtypes(reader, blocks):
     head = reader(BytesIO(blocks[0][0]), header=0)
     header = blocks[0][0].split(b"\n")[0] + b"\n"
-    dfs = text_blocks_to_pandas(reader, blocks, header, head, {})
+    dfs = text_blocks_to_pandas(reader, blocks, header, head, {}, blocksize=None)
     dfs = dask.compute(dfs, scheduler="sync")
     assert all(df.dtypes.to_dict() == head.dtypes.to_dict() for df in dfs)
 
@@ -302,7 +302,7 @@ def test_enforce_columns(reader, blocks):
     head = reader(BytesIO(blocks[0][0]), header=0)
     header = blocks[0][0].split(b"\n")[0] + b"\n"
     with pytest.raises(ValueError):
-        dfs = text_blocks_to_pandas(reader, blocks, header, head, {}, enforce=True)
+        dfs = text_blocks_to_pandas(reader, blocks, header, head, {}, enforce=True, blocksize=None)
         dask.compute(*dfs, scheduler="sync")
 
 
+ source /opt/miniconda3/bin/activate
++ _CONDA_ROOT=/opt/miniconda3
++ . /opt/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ '[' -z x ']'
++ conda activate
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate
++ '[' -n '' ']'
++ local ask_conda
+++ PS1='(testbed) '
+++ __conda_exe shell.posix activate
+++ /opt/miniconda3/bin/conda shell.posix activate
++ ask_conda='. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/libxml2_deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/libglib_deactivate.sh"
PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/opt/miniconda3/envs/testbed'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ eval '. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/libxml2_deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/libglib_deactivate.sh"
PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/opt/miniconda3/envs/testbed'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+++ . /opt/miniconda3/envs/testbed/etc/conda/deactivate.d/libxml2_deactivate.sh
++++ test -n ''
++++ unset XML_CATALOG_FILES
++++ unset xml_catalog_files_libxml2
+++ . /opt/miniconda3/envs/testbed/etc/conda/deactivate.d/libglib_deactivate.sh
++++ export GSETTINGS_SCHEMA_DIR=
++++ GSETTINGS_SCHEMA_DIR=
++++ unset GSETTINGS_SCHEMA_DIR_CONDA_BACKUP
++++ '[' -z ']'
++++ unset GSETTINGS_SCHEMA_DIR
+++ PS1='(base) '
+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export CONDA_PREFIX=/opt/miniconda3
+++ CONDA_PREFIX=/opt/miniconda3
+++ export CONDA_SHLVL=3
+++ CONDA_SHLVL=3
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
+++ export CONDA_PREFIX_2=/opt/miniconda3/envs/testbed
+++ CONDA_PREFIX_2=/opt/miniconda3/envs/testbed
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ conda activate testbed
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate testbed
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate testbed
++ /opt/miniconda3/bin/conda shell.posix activate testbed
+ ask_conda='PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_3='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\''
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libglib_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh"'
+ eval 'PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_3='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\''
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libglib_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh"'
++ PS1='(testbed) '
++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ export CONDA_SHLVL=4
++ CONDA_SHLVL=4
++ export CONDA_DEFAULT_ENV=testbed
++ CONDA_DEFAULT_ENV=testbed
++ export 'CONDA_PROMPT_MODIFIER=(testbed) '
++ CONDA_PROMPT_MODIFIER='(testbed) '
++ export CONDA_PREFIX_3=/opt/miniconda3
++ CONDA_PREFIX_3=/opt/miniconda3
++ export CONDA_EXE=/opt/miniconda3/bin/conda
++ CONDA_EXE=/opt/miniconda3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/libglib_activate.sh
+++ export GSETTINGS_SCHEMA_DIR_CONDA_BACKUP=
+++ GSETTINGS_SCHEMA_DIR_CONDA_BACKUP=
+++ export GSETTINGS_SCHEMA_DIR=/opt/miniconda3/envs/testbed/share/glib-2.0/schemas
+++ GSETTINGS_SCHEMA_DIR=/opt/miniconda3/envs/testbed/share/glib-2.0/schemas
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh
+++ test -n ''
+++ xml_catalog_files_libxml2=
+++ XML_CATALOG_FILES=
+++ conda_catalog_files=
+++ ifs_libxml2=' 	
'
+++ IFS=' '
+++ rem=/opt/miniconda3/envs/testbed
+++ for pre in ${rem}
+++ test '' = /opt/miniconda3/envs/testbed
+++ conda_catalog_files=/opt/miniconda3/envs/testbed
+++ rem=
+++ IFS=' 	
'
+++ conda_catalog_files='file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ export 'XML_CATALOG_FILES=file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ XML_CATALOG_FILES='file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ unset conda_catalog_files ifs_libxml2 rem
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r
+ python -m pip install --no-deps -e .
Obtaining file:///testbed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Installing collected packages: dask
  Attempting uninstall: dask
    Found existing installation: dask 2.30.0+45.g554ca8877
    Uninstalling dask-2.30.0+45.g554ca8877:
      Successfully uninstalled dask-2.30.0+45.g554ca8877
  DEPRECATION: Legacy editable install of dask==2.30.0+45.g554ca8877.dirty from file:///testbed (setup.py develop) is deprecated. pip 25.0 will enforce this behaviour change. A possible replacement is to add a pyproject.toml or enable --use-pep517, and use setuptools >= 64. If the resulting installation is not behaving as expected, try using --config-settings editable_mode=compat. Please consult the setuptools documentation for more information. Discussion can be found at https://github.com/pypa/pip/issues/11457
  Running setup.py develop for dask
Successfully installed dask
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
+ git checkout 554ca8877d36d30732712698f3135e13edd6654a dask/dataframe/io/tests/test_csv.py
Updated 1 path from f4dc03e43
+ git apply -v -
Checking patch dask/dataframe/io/tests/test_csv.py...
Applied patch dask/dataframe/io/tests/test_csv.py cleanly.
+ pytest -n0 -rA --color=no dask/dataframe/io/tests/test_csv.py
============================= test session starts ==============================
platform linux -- Python 3.8.15, pytest-8.3.4, pluggy-1.5.0
rootdir: /testbed
configfile: setup.cfg
plugins: xdist-3.6.1
collected 136 items

dask/dataframe/io/tests/test_csv.py .................................... [ 26%]
............F........s.......s.ss....s.sss...........s....Fxx........... [ 79%]
.....x......................                                             [100%]

=================================== FAILURES ===================================
_____________________________ test_read_csv_index ______________________________

    def test_read_csv_index():
        with filetext(csv_text) as fn:
            f = dd.read_csv(fn, blocksize=20).set_index("amount")
>           result = f.compute(scheduler="sync")

dask/dataframe/io/tests/test_csv.py:468: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
dask/base.py:224: in compute
    (result,) = compute(self, traverse=False, **kwargs)
dask/base.py:511: in compute
    results = schedule(dsk, keys, **kwargs)
dask/local.py:527: in get_sync
    return get_async(apply_sync, 1, dsk, keys, **kwargs)
dask/local.py:494: in get_async
    fire_task()
dask/local.py:456: in fire_task
    apply_async(
dask/local.py:516: in apply_sync
    res = func(*args, **kwds)
dask/local.py:227: in execute_task
    result = pack_exception(e, dumps)
dask/local.py:222: in execute_task
    result = _execute_task(task, data)
dask/core.py:121: in _execute_task
    return func(*(_execute_task(a, cache) for a in args))
dask/dataframe/shuffle.py:1213: in shuffle_group_3
    p.append(d, fsync=True)
/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/partd/encode.py:23: in append
    data = valmap(self.encode, data)
/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/toolz/dicttoolz.py:85: in valmap
    rv.update(zip(d.keys(), map(func, d.values())))
/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/partd/pandas.py:180: in serialize
    for block in df._mgr.blocks:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self =     name  amount  _partitions
0  Alice     100            3
name = '_mgr'

    def __getattr__(self, name: str):
        """After regular attribute access, try looking up the name
        This allows simpler access to columns for interactive use.
        """
    
        # Note: obj.x will always call obj.__getattribute__('x') prior to
        # calling obj.__getattr__('x').
    
        if (
            name in self._internal_names_set
            or name in self._metadata
            or name in self._accessors
        ):
            return object.__getattribute__(self, name)
        else:
            if self._info_axis._can_hold_identifiers_and_holds_name(name):
                return self[name]
>           return object.__getattribute__(self, name)
E           AttributeError: 'DataFrame' object has no attribute '_mgr'

/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/pandas/core/generic.py:5274: AttributeError
________________ test_read_csv_with_datetime_index_partitions_n ________________

    def test_read_csv_with_datetime_index_partitions_n():
        with filetext(timeseries) as fn:
            df = pd.read_csv(
                fn, index_col=0, header=0, usecols=[0, 4], parse_dates=["Date"]
            )
            # because fn is so small, by default, set chunksize small
            ddf = dd.read_csv(
                fn, header=0, usecols=[0, 4], parse_dates=["Date"], blocksize=400
            ).set_index("Date")
>           assert_eq(df, ddf)

dask/dataframe/io/tests/test_csv.py:1047: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
dask/dataframe/utils.py:809: in assert_eq
    assert_divisions(b)
dask/dataframe/utils.py:874: in assert_divisions
    results = get_sync(ddf.dask, ddf.__dask_keys__())
dask/local.py:527: in get_sync
    return get_async(apply_sync, 1, dsk, keys, **kwargs)
dask/local.py:494: in get_async
    fire_task()
dask/local.py:456: in fire_task
    apply_async(
dask/local.py:516: in apply_sync
    res = func(*args, **kwds)
dask/local.py:227: in execute_task
    result = pack_exception(e, dumps)
dask/local.py:222: in execute_task
    result = _execute_task(task, data)
dask/core.py:121: in _execute_task
    return func(*(_execute_task(a, cache) for a in args))
dask/dataframe/shuffle.py:1213: in shuffle_group_3
    p.append(d, fsync=True)
/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/partd/encode.py:23: in append
    data = valmap(self.encode, data)
/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/toolz/dicttoolz.py:85: in valmap
    rv.update(zip(d.keys(), map(func, d.values())))
/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/partd/pandas.py:180: in serialize
    for block in df._mgr.blocks:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self =         Date       Close  _partitions
0 2015-08-28  199.240005            1
1 2015-08-27  199.160004            1
2 2015-08-26  194.679993            1
3 2015-08-25  187.229996            1
4 2015-08-24  189.550003            1
name = '_mgr'

    def __getattr__(self, name: str):
        """After regular attribute access, try looking up the name
        This allows simpler access to columns for interactive use.
        """
    
        # Note: obj.x will always call obj.__getattribute__('x') prior to
        # calling obj.__getattr__('x').
    
        if (
            name in self._internal_names_set
            or name in self._metadata
            or name in self._accessors
        ):
            return object.__getattribute__(self, name)
        else:
            if self._info_axis._can_hold_identifiers_and_holds_name(name):
                return self[name]
>           return object.__getattribute__(self, name)
E           AttributeError: 'DataFrame' object has no attribute '_mgr'

/opt/miniconda3/envs/testbed/lib/python3.8/site-packages/pandas/core/generic.py:5274: AttributeError
=============================== warnings summary ===============================
../opt/miniconda3/envs/testbed/lib/python3.8/site-packages/chest/core.py:1
  /opt/miniconda3/envs/testbed/lib/python3.8/site-packages/chest/core.py:1: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working
    from collections import MutableMapping

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
==================================== PASSES ====================================
============================= slowest 10 durations =============================
1.75s call     dask/dataframe/io/tests/test_csv.py::test_to_csv_with_get
1.30s call     dask/dataframe/io/tests/test_csv.py::test_to_csv_warns_using_scheduler_argument
1.17s call     dask/dataframe/io/tests/test_csv.py::test_to_csv_keeps_all_non_scheduler_compute_kwargs
1.08s call     dask/dataframe/io/tests/test_csv.py::test_to_csv_errors_using_multiple_scheduler_args
0.29s call     dask/dataframe/io/tests/test_csv.py::test_pandas_read_text[read_fwf-files2]
0.18s call     dask/dataframe/io/tests/test_csv.py::test_to_csv_multiple_files_cornercases
0.14s call     dask/dataframe/io/tests/test_csv.py::test_read_csv_slash_r
0.11s call     dask/dataframe/io/tests/test_csv.py::test_categorical_known
0.11s call     dask/dataframe/io/tests/test_csv.py::test_to_csv
0.09s call     dask/dataframe/io/tests/test_csv.py::test_usecols
=========================== short test summary info ============================
PASSED dask/dataframe/io/tests/test_csv.py::test_pandas_read_text[read_csv-files0]
PASSED dask/dataframe/io/tests/test_csv.py::test_pandas_read_text[read_table-files1]
PASSED dask/dataframe/io/tests/test_csv.py::test_pandas_read_text[read_fwf-files2]
PASSED dask/dataframe/io/tests/test_csv.py::test_pandas_read_text_kwargs[read_csv-files0]
PASSED dask/dataframe/io/tests/test_csv.py::test_pandas_read_text_kwargs[read_table-files1]
PASSED dask/dataframe/io/tests/test_csv.py::test_pandas_read_text_kwargs[read_fwf-files2]
PASSED dask/dataframe/io/tests/test_csv.py::test_pandas_read_text_dtype_coercion[read_csv-files0]
PASSED dask/dataframe/io/tests/test_csv.py::test_pandas_read_text_dtype_coercion[read_table-files1]
PASSED dask/dataframe/io/tests/test_csv.py::test_pandas_read_text_dtype_coercion[read_fwf-files2]
PASSED dask/dataframe/io/tests/test_csv.py::test_pandas_read_text_with_header[read_csv-files0]
PASSED dask/dataframe/io/tests/test_csv.py::test_pandas_read_text_with_header[read_table-files1]
PASSED dask/dataframe/io/tests/test_csv.py::test_pandas_read_text_with_header[read_fwf-files2]
PASSED dask/dataframe/io/tests/test_csv.py::test_text_blocks_to_pandas_simple[read_csv-files0]
PASSED dask/dataframe/io/tests/test_csv.py::test_text_blocks_to_pandas_simple[read_table-files1]
PASSED dask/dataframe/io/tests/test_csv.py::test_text_blocks_to_pandas_simple[read_fwf-files2]
PASSED dask/dataframe/io/tests/test_csv.py::test_text_blocks_to_pandas_kwargs[read_csv-files0]
PASSED dask/dataframe/io/tests/test_csv.py::test_text_blocks_to_pandas_kwargs[read_table-files1]
PASSED dask/dataframe/io/tests/test_csv.py::test_text_blocks_to_pandas_kwargs[read_fwf-files2]
PASSED dask/dataframe/io/tests/test_csv.py::test_text_blocks_to_pandas_blocked[read_csv-files0]
PASSED dask/dataframe/io/tests/test_csv.py::test_text_blocks_to_pandas_blocked[read_table-files1]
PASSED dask/dataframe/io/tests/test_csv.py::test_text_blocks_to_pandas_blocked[read_fwf-files2]
PASSED dask/dataframe/io/tests/test_csv.py::test_skiprows[read_csv-read_csv-files0]
PASSED dask/dataframe/io/tests/test_csv.py::test_skiprows[read_table-read_table-files1]
PASSED dask/dataframe/io/tests/test_csv.py::test_skiprows_as_list[read_csv-read_csv-files0-str, int, int\n]
PASSED dask/dataframe/io/tests/test_csv.py::test_skiprows_as_list[read_table-read_table-files1-str\t int\t int\n]
PASSED dask/dataframe/io/tests/test_csv.py::test_enforce_dtypes[read_csv-blocks0]
PASSED dask/dataframe/io/tests/test_csv.py::test_enforce_dtypes[read_table-blocks1]
PASSED dask/dataframe/io/tests/test_csv.py::test_enforce_columns[read_csv-blocks0]
PASSED dask/dataframe/io/tests/test_csv.py::test_enforce_columns[read_table-blocks1]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv[read_csv-read_csv-name,amount\nAlice,100\nBob,-200\nCharlie,300\nDennis,400\nEdith,-500\nFrank,600\nAlice,200\nFrank,-200\nBob,600\nAlice,400\nFrank,200\nAlice,300\nEdith,600-,]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv[read_table-read_table-name\tamount\nAlice\t100\nBob\t-200\nCharlie\t300\nDennis\t400\nEdith\t-500\nFrank\t600\nAlice\t200\nFrank\t-200\nBob\t600\nAlice\t400\nFrank\t200\nAlice\t300\nEdith\t600-\t]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv[read_table-read_table-name   amount\nAlice    100\nBob     -200\nCharlie  300\nDennis   400\nEdith   -500\nFrank    600\nAlice    200\nFrank   -200\nBob      600\nAlice    400\nFrank    200\nAlice    300\nEdith    600-\\s+]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_large_skiprows[read_csv-read_csv-name,amount\nAlice,100\nBob,-200\nCharlie,300\nDennis,400\nEdith,-500\nFrank,600\nAlice,200\nFrank,-200\nBob,600\nAlice,400\nFrank,200\nAlice,300\nEdith,600-7]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_large_skiprows[read_table-read_table-name\tamount\nAlice\t100\nBob\t-200\nCharlie\t300\nDennis\t400\nEdith\t-500\nFrank\t600\nAlice\t200\nFrank\t-200\nBob\t600\nAlice\t400\nFrank\t200\nAlice\t300\nEdith\t600-skip1]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_skiprows_only_in_first_partition[read_csv-read_csv-name,amount\nAlice,100\nBob,-200\nCharlie,300\nDennis,400\nEdith,-500\nFrank,600\nAlice,200\nFrank,-200\nBob,600\nAlice,400\nFrank,200\nAlice,300\nEdith,600-7]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_skiprows_only_in_first_partition[read_table-read_table-name\tamount\nAlice\t100\nBob\t-200\nCharlie\t300\nDennis\t400\nEdith\t-500\nFrank\t600\nAlice\t200\nFrank\t-200\nBob\t600\nAlice\t400\nFrank\t200\nAlice\t300\nEdith\t600-skip1]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_files[read_csv-read_csv-files0]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_files[read_table-read_table-files1]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_files_list[read_csv-read_csv-files0]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_files_list[read_table-read_table-files1]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_include_path_column[read_csv-files0]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_include_path_column[read_table-files1]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_include_path_column_as_str[read_csv-files0]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_include_path_column_as_str[read_table-files1]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_include_path_column_with_duplicate_name[read_csv-files0]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_include_path_column_with_duplicate_name[read_table-files1]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_include_path_column_is_dtype_category[read_csv-files0]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_include_path_column_is_dtype_category[read_table-files1]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_skiprows_range
PASSED dask/dataframe/io/tests/test_csv.py::test_usecols
PASSED dask/dataframe/io/tests/test_csv.py::test_string_blocksize
PASSED dask/dataframe/io/tests/test_csv.py::test_skipinitialspace
PASSED dask/dataframe/io/tests/test_csv.py::test_consistent_dtypes
PASSED dask/dataframe/io/tests/test_csv.py::test_consistent_dtypes_2
PASSED dask/dataframe/io/tests/test_csv.py::test_categorical_dtypes
PASSED dask/dataframe/io/tests/test_csv.py::test_categorical_known
PASSED dask/dataframe/io/tests/test_csv.py::test_empty_csv_file
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_no_sample
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_sensitive_to_enforce
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_compression[None-None]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_compression[zip-None]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_compression[bz2-None]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_compression[gzip-None]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_compression[xz-None]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_compression[None-10]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_compression[zip-10]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_compression[bz2-10]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_compression[gzip-10]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_compression[xz-10]
PASSED dask/dataframe/io/tests/test_csv.py::test_windows_line_terminator
PASSED dask/dataframe/io/tests/test_csv.py::test_header_None
PASSED dask/dataframe/io/tests/test_csv.py::test_auto_blocksize
PASSED dask/dataframe/io/tests/test_csv.py::test_auto_blocksize_max64mb
PASSED dask/dataframe/io/tests/test_csv.py::test_auto_blocksize_csv
PASSED dask/dataframe/io/tests/test_csv.py::test_head_partial_line_fix
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_raises_on_no_files
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_has_deterministic_name
PASSED dask/dataframe/io/tests/test_csv.py::test_multiple_read_csv_has_deterministic_name
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_has_different_names_based_on_blocksize
PASSED dask/dataframe/io/tests/test_csv.py::test_csv_with_integer_names
PASSED dask/dataframe/io/tests/test_csv.py::test_late_dtypes
PASSED dask/dataframe/io/tests/test_csv.py::test_assume_missing
PASSED dask/dataframe/io/tests/test_csv.py::test_index_col
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_with_datetime_index_partitions_one
PASSED dask/dataframe/io/tests/test_csv.py::test_encoding_gh601[utf-16-be]
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_header_issue_823
PASSED dask/dataframe/io/tests/test_csv.py::test_none_usecols
PASSED dask/dataframe/io/tests/test_csv.py::test_parse_dates_multi_column
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_sep
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_slash_r
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_singleton_dtype
PASSED dask/dataframe/io/tests/test_csv.py::test_robust_column_mismatch
PASSED dask/dataframe/io/tests/test_csv.py::test_error_if_sample_is_too_small
PASSED dask/dataframe/io/tests/test_csv.py::test_read_csv_names_not_none
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_multiple_files_cornercases
PASSED dask/dataframe/io/tests/test_csv.py::test_to_single_csv
PASSED dask/dataframe/io/tests/test_csv.py::test_to_single_csv_with_name_function
PASSED dask/dataframe/io/tests/test_csv.py::test_to_single_csv_with_header_first_partition_only
PASSED dask/dataframe/io/tests/test_csv.py::test_to_single_csv_gzip
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_nodir
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_simple
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_series
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_with_get
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_warns_using_scheduler_argument
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_errors_using_multiple_scheduler_args
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_keeps_all_non_scheduler_compute_kwargs
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_paths
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_header_empty_dataframe[False-]
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_header_empty_dataframe[True-x,y\n]
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_header[False-False-a,1\n-d,4\n]
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_header[True-False-x,y\n-x,y\n]
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_header[False-True-a,1\n-d,4\n]
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_header[True-True-x,y\n-d,4\n]
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_header[header4-False-aa,bb\n-aa,bb\n]
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_header[header5-True-aa,bb\n-d,4\n]
PASSED dask/dataframe/io/tests/test_csv.py::test_to_csv_line_ending
PASSED dask/dataframe/io/tests/test_csv.py::test_block_mask[block_lists0]
PASSED dask/dataframe/io/tests/test_csv.py::test_block_mask[block_lists1]
PASSED dask/dataframe/io/tests/test_csv.py::test_block_mask[block_lists2]
PASSED dask/dataframe/io/tests/test_csv.py::test_block_mask[block_lists3]
PASSED dask/dataframe/io/tests/test_csv.py::test_reading_empty_csv_files_with_path
SKIPPED [2] conftest.py:25: need --runslow option to run
SKIPPED [2] dask/dataframe/io/tests/test_csv.py:705: compress function not provided for lzma
SKIPPED [2] dask/dataframe/io/tests/test_csv.py:705: compress function not provided for snappy
SKIPPED [2] dask/dataframe/io/tests/test_csv.py:705: compress function not provided for lz4
SKIPPED [1] dask/dataframe/io/tests/test_csv.py:720: unconditional skip
XFAIL dask/dataframe/io/tests/test_csv.py::test_encoding_gh601[utf-16] - https://github.com/dask/dask/issues/5787
XFAIL dask/dataframe/io/tests/test_csv.py::test_encoding_gh601[utf-16-le] - https://github.com/dask/dask/issues/5787
XFAIL dask/dataframe/io/tests/test_csv.py::test_to_csv_gzip - to_csv does not support compression
FAILED dask/dataframe/io/tests/test_csv.py::test_read_csv_index - AttributeEr...
FAILED dask/dataframe/io/tests/test_csv.py::test_read_csv_with_datetime_index_partitions_n
======= 2 failed, 122 passed, 9 skipped, 3 xfailed, 1 warning in 12.13s ========
+ git checkout 554ca8877d36d30732712698f3135e13edd6654a dask/dataframe/io/tests/test_csv.py
Updated 1 path from f4dc03e43
