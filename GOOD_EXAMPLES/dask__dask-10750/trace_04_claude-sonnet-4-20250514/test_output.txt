+ source /opt/miniconda3/bin/activate
++ _CONDA_ROOT=/opt/miniconda3
++ . /opt/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /opt/miniconda3/bin/conda
++++ dirname /opt/miniconda3/bin
+++ PATH=/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate
+++ /opt/miniconda3/bin/conda shell.posix activate
++ ask_conda='PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ eval 'PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+++ PS1='(base) '
+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export CONDA_PREFIX=/opt/miniconda3
+++ CONDA_PREFIX=/opt/miniconda3
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ conda activate testbed
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate testbed
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate testbed
++ /opt/miniconda3/bin/conda shell.posix activate testbed
+ ask_conda='PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''2'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_1='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\''
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libarrow_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libglib_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh"'
+ eval 'PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''2'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_1='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\''
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libarrow_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libglib_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh"'
++ PS1='(testbed) '
++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ export CONDA_SHLVL=2
++ CONDA_SHLVL=2
++ export CONDA_DEFAULT_ENV=testbed
++ CONDA_DEFAULT_ENV=testbed
++ export 'CONDA_PROMPT_MODIFIER=(testbed) '
++ CONDA_PROMPT_MODIFIER='(testbed) '
++ export CONDA_PREFIX_1=/opt/miniconda3
++ CONDA_PREFIX_1=/opt/miniconda3
++ export CONDA_EXE=/opt/miniconda3/bin/conda
++ CONDA_EXE=/opt/miniconda3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/libarrow_activate.sh
+++ _la_log 'Beginning libarrow activation.'
+++ '[' '' = 1 ']'
+++ _la_gdb_prefix=/opt/miniconda3/envs/testbed/share/gdb/auto-load
+++ '[' '!' -w /opt/miniconda3/envs/testbed/share/gdb/auto-load ']'
+++ _la_placeholder=replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX
+++ _la_symlink_dir=/opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib
+++ _la_orig_install_dir=/opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib
+++ _la_log '          _la_gdb_prefix: /opt/miniconda3/envs/testbed/share/gdb/auto-load'
+++ '[' '' = 1 ']'
+++ _la_log '         _la_placeholder: replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX'
+++ '[' '' = 1 ']'
+++ _la_log '         _la_symlink_dir: /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib'
+++ '[' '' = 1 ']'
+++ _la_log '    _la_orig_install_dir: /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib'
+++ '[' '' = 1 ']'
+++ _la_log '  content of that folder:'
+++ '[' '' = 1 ']'
++++ ls -al /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib
++++ sed 's/^/      /'
+++ _la_log '      total 12
      drwxr-xr-x 2 root root 4096 Nov 15 07:40 .
      drwxr-xr-x 3 root root 4096 Nov 15 07:40 ..
      -rw-r--r-- 1 root root  971 Nov 15 07:39 libarrow.so.1000.1.0-gdb.py'
+++ '[' '' = 1 ']'
+++ for _la_target in "$_la_orig_install_dir/"*.py
+++ '[' '!' -e /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.1000.1.0-gdb.py ']'
++++ basename /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.1000.1.0-gdb.py
+++ _la_symlink=/opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.1000.1.0-gdb.py
+++ _la_log '   _la_target: /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.1000.1.0-gdb.py'
+++ '[' '' = 1 ']'
+++ _la_log '  _la_symlink: /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.1000.1.0-gdb.py'
+++ '[' '' = 1 ']'
+++ '[' -L /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.1000.1.0-gdb.py ']'
++++ readlink /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.1000.1.0-gdb.py
+++ '[' /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.1000.1.0-gdb.py = /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.1000.1.0-gdb.py ']'
+++ _la_log 'symlink $_la_symlink already exists and points to $_la_target, skipping.'
+++ '[' '' = 1 ']'
+++ continue
+++ _la_log 'Libarrow activation complete.'
+++ '[' '' = 1 ']'
+++ unset _la_gdb_prefix
+++ unset _la_log
+++ unset _la_orig_install_dir
+++ unset _la_placeholder
+++ unset _la_symlink
+++ unset _la_symlink_dir
+++ unset _la_target
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/libglib_activate.sh
+++ export GSETTINGS_SCHEMA_DIR_CONDA_BACKUP=
+++ GSETTINGS_SCHEMA_DIR_CONDA_BACKUP=
+++ export GSETTINGS_SCHEMA_DIR=/opt/miniconda3/envs/testbed/share/glib-2.0/schemas
+++ GSETTINGS_SCHEMA_DIR=/opt/miniconda3/envs/testbed/share/glib-2.0/schemas
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh
+++ test -n ''
+++ xml_catalog_files_libxml2=
+++ XML_CATALOG_FILES=
+++ conda_catalog_files=
+++ ifs_libxml2=' 	
'
+++ IFS=' '
+++ rem=/opt/miniconda3/envs/testbed
+++ for pre in ${rem}
+++ test '' = /opt/miniconda3/envs/testbed
+++ conda_catalog_files=/opt/miniconda3/envs/testbed
+++ rem=
+++ IFS=' 	
'
+++ conda_catalog_files='file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ export 'XML_CATALOG_FILES=file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ XML_CATALOG_FILES='file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ unset conda_catalog_files ifs_libxml2 rem
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r
+ cd /testbed
+ git config --global --add safe.directory /testbed
+ cd /testbed
+ git status
On branch main
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
	modified:   dask/dataframe/core.py
	modified:   dask/dataframe/shuffle.py

no changes added to commit (use "git add" and/or "git commit -a")
+ git show
commit 6d5b994cb58f295c27bd888de0f67c83ed568d3d
Author: Matthew Rocklin <mrocklin@gmail.com>
Date:   Thu Jan 4 11:00:46 2024 -0600

    Make dask.array.utils functions more generic to other Dask Arrays (#10676)

diff --git a/dask/array/utils.py b/dask/array/utils.py
index 39da95be7..9fe33f91c 100644
--- a/dask/array/utils.py
+++ b/dask/array/utils.py
@@ -12,7 +12,7 @@ from tlz import concat, frequencies
 
 from dask.array.core import Array
 from dask.array.numpy_compat import AxisError
-from dask.base import tokenize
+from dask.base import is_dask_collection, tokenize
 from dask.highlevelgraph import HighLevelGraph
 from dask.utils import has_keyword, is_arraylike, is_cupy_type, typename
 
@@ -43,7 +43,7 @@ def meta_from_array(x, ndim=None, dtype=None):
     """
     # If using x._meta, x must be a Dask Array, some libraries (e.g. zarr)
     # implement a _meta attribute that are incompatible with Dask Array._meta
-    if hasattr(x, "_meta") and isinstance(x, Array):
+    if hasattr(x, "_meta") and is_dask_collection(x) and is_arraylike(x):
         x = x._meta
 
     if dtype is None and x is None:
@@ -264,7 +264,7 @@ def _get_dt_meta_computed(
     x_meta = None
     x_computed = None
 
-    if isinstance(x, Array):
+    if is_dask_collection(x) and is_arraylike(x):
         assert x.dtype is not None
         adt = x.dtype
         if check_graph:
diff --git a/dask/base.py b/dask/base.py
index cb2832c8e..547bb4063 100644
--- a/dask/base.py
+++ b/dask/base.py
@@ -210,11 +210,27 @@ def is_dask_collection(x) -> bool:
     implementation of the protocol.
 
     """
-    try:
-        return x.__dask_graph__() is not None
-    except (AttributeError, TypeError):
+    if (
+        isinstance(x, type)
+        or not hasattr(x, "__dask_graph__")
+        or not callable(x.__dask_graph__)
+    ):
         return False
 
+    pkg_name = getattr(type(x), "__module__", "").split(".")[0]
+    if pkg_name == "dask_expr":
+        # Temporary hack to avoid graph materialization. Note that this won't work with
+        # dask_expr.array objects wrapped by xarray or pint. By the time dask_expr.array
+        # is published, we hope to be able to rewrite this method completely.
+        # Read: https://github.com/dask/dask/pull/10676
+        return True
+
+    # xarray, pint, and possibly other wrappers always define a __dask_graph__ method,
+    # but it may return None if they wrap around a non-dask object.
+    # In all known dask collections other than dask-expr,
+    # calling __dask_graph__ is cheap.
+    return x.__dask_graph__() is not None
+
 
 class DaskMethodsMixin:
     """A mixin adding standard dask collection methods"""
diff --git a/dask/tests/test_base.py b/dask/tests/test_base.py
index d0fc9489c..f59a8f626 100644
--- a/dask/tests/test_base.py
+++ b/dask/tests/test_base.py
@@ -682,6 +682,43 @@ def test_is_dask_collection():
     assert not is_dask_collection(DummyCollection)
 
 
+def test_is_dask_collection_dask_expr():
+    pd = pytest.importorskip("pandas")
+    dx = pytest.importorskip("dask_expr")
+
+    df = pd.Series([1, 2, 3])
+    dxf = dx.from_pandas(df)
+    assert not is_dask_collection(df)
+    assert is_dask_collection(dxf)
+
+
+def test_is_dask_collection_dask_expr_does_not_materialize():
+    dx = pytest.importorskip("dask_expr")
+
+    class DoNotMaterialize(dx._core.Expr):
+        @property
+        def _meta(self):
+            return 0
+
+        def __dask_keys__(self):
+            assert False, "must not reach"
+
+        def __dask_graph__(self):
+            assert False, "must not reach"
+
+        def optimize(self, fuse=False):
+            assert False, "must not reach"
+
+    coll = dx._collection.new_collection(DoNotMaterialize())
+
+    with pytest.raises(AssertionError, match="must not reach"):
+        coll.__dask_keys__()
+    with pytest.raises(AssertionError, match="must not reach"):
+        coll.__dask_graph__()
+
+    assert is_dask_collection(coll)
+
+
 def test_unpack_collections():
     class ANamedTuple(NamedTuple):
         a: int  # type: ignore[annotation-unchecked]
+ git diff 6d5b994cb58f295c27bd888de0f67c83ed568d3d
diff --git a/dask/dataframe/core.py b/dask/dataframe/core.py
index e1e7904a4..251f57d5b 100644
--- a/dask/dataframe/core.py
+++ b/dask/dataframe/core.py
@@ -5241,6 +5241,9 @@ class DataFrame(_Frame):
         npartitions: int, None, or 'auto'
             The ideal number of output partitions. If None, use the same as
             the input. If 'auto' then decide by memory use.
+            
+            .. deprecated:: 
+                The 'auto' value is deprecated and will be removed in a future version.
         ascending: bool, optional
             Sort ascending vs. descending.
             Defaults to True.
@@ -5322,6 +5325,9 @@ class DataFrame(_Frame):
             the input. If 'auto' then decide by memory use.
             Only used when ``divisions`` is not given. If ``divisions`` is given,
             the number of output partitions will be ``len(divisions) - 1``.
+            
+            .. deprecated:: 
+                The 'auto' value is deprecated and will be removed in a future version.
         divisions: list, optional
             The "dividing lines" used to split the new index into partitions.
             For ``divisions=[0, 10, 50, 100]``, there would be three output partitions,
diff --git a/dask/dataframe/shuffle.py b/dask/dataframe/shuffle.py
index 270df6da4..604ff8bcb 100644
--- a/dask/dataframe/shuffle.py
+++ b/dask/dataframe/shuffle.py
@@ -166,6 +166,12 @@ def sort_values(
         return df.map_partitions(sort_function, **sort_kwargs)
 
     if npartitions == "auto":
+        warnings.warn(
+            "The 'auto' value for npartitions is deprecated and will be removed in a future version. "
+            "Please specify an explicit number of partitions instead.",
+            FutureWarning,
+            stacklevel=2
+        )
         repartition = True
         npartitions = max(100, df.npartitions)
     else:
@@ -235,6 +241,12 @@ def set_index(
         ).clear_divisions()
 
     if npartitions == "auto":
+        warnings.warn(
+            "The 'auto' value for npartitions is deprecated and will be removed in a future version. "
+            "Please specify an explicit number of partitions instead.",
+            FutureWarning,
+            stacklevel=2
+        )
         repartition = True
         npartitions = max(100, df.npartitions)
     else:
+ source /opt/miniconda3/bin/activate
++ _CONDA_ROOT=/opt/miniconda3
++ . /opt/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ '[' -z x ']'
++ conda activate
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate
++ '[' -n '' ']'
++ local ask_conda
+++ PS1='(testbed) '
+++ __conda_exe shell.posix activate
+++ /opt/miniconda3/bin/conda shell.posix activate
++ ask_conda='. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/libxml2_deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/libglib_deactivate.sh"
PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/opt/miniconda3/envs/testbed'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ eval '. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/libxml2_deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/libglib_deactivate.sh"
PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/opt/miniconda3/envs/testbed'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+++ . /opt/miniconda3/envs/testbed/etc/conda/deactivate.d/libxml2_deactivate.sh
++++ test -n ''
++++ unset XML_CATALOG_FILES
++++ unset xml_catalog_files_libxml2
+++ . /opt/miniconda3/envs/testbed/etc/conda/deactivate.d/libglib_deactivate.sh
++++ export GSETTINGS_SCHEMA_DIR=
++++ GSETTINGS_SCHEMA_DIR=
++++ unset GSETTINGS_SCHEMA_DIR_CONDA_BACKUP
++++ '[' -z ']'
++++ unset GSETTINGS_SCHEMA_DIR
+++ PS1='(base) '
+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export CONDA_PREFIX=/opt/miniconda3
+++ CONDA_PREFIX=/opt/miniconda3
+++ export CONDA_SHLVL=3
+++ CONDA_SHLVL=3
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
+++ export CONDA_PREFIX_2=/opt/miniconda3/envs/testbed
+++ CONDA_PREFIX_2=/opt/miniconda3/envs/testbed
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ conda activate testbed
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate testbed
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate testbed
++ /opt/miniconda3/bin/conda shell.posix activate testbed
+ ask_conda='PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_3='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\''
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libarrow_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libglib_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh"'
+ eval 'PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_3='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\''
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libarrow_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libglib_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh"'
++ PS1='(testbed) '
++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ export CONDA_SHLVL=4
++ CONDA_SHLVL=4
++ export CONDA_DEFAULT_ENV=testbed
++ CONDA_DEFAULT_ENV=testbed
++ export 'CONDA_PROMPT_MODIFIER=(testbed) '
++ CONDA_PROMPT_MODIFIER='(testbed) '
++ export CONDA_PREFIX_3=/opt/miniconda3
++ CONDA_PREFIX_3=/opt/miniconda3
++ export CONDA_EXE=/opt/miniconda3/bin/conda
++ CONDA_EXE=/opt/miniconda3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/libarrow_activate.sh
+++ _la_log 'Beginning libarrow activation.'
+++ '[' '' = 1 ']'
+++ _la_gdb_prefix=/opt/miniconda3/envs/testbed/share/gdb/auto-load
+++ '[' '!' -w /opt/miniconda3/envs/testbed/share/gdb/auto-load ']'
+++ _la_placeholder=replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX
+++ _la_symlink_dir=/opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib
+++ _la_orig_install_dir=/opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib
+++ _la_log '          _la_gdb_prefix: /opt/miniconda3/envs/testbed/share/gdb/auto-load'
+++ '[' '' = 1 ']'
+++ _la_log '         _la_placeholder: replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX'
+++ '[' '' = 1 ']'
+++ _la_log '         _la_symlink_dir: /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib'
+++ '[' '' = 1 ']'
+++ _la_log '    _la_orig_install_dir: /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib'
+++ '[' '' = 1 ']'
+++ _la_log '  content of that folder:'
+++ '[' '' = 1 ']'
++++ ls -al /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib
++++ sed 's/^/      /'
+++ _la_log '      total 12
      drwxr-xr-x 2 root root 4096 Nov 15 07:40 .
      drwxr-xr-x 3 root root 4096 Nov 15 07:40 ..
      -rw-r--r-- 1 root root  971 Nov 15 07:39 libarrow.so.1000.1.0-gdb.py'
+++ '[' '' = 1 ']'
+++ for _la_target in "$_la_orig_install_dir/"*.py
+++ '[' '!' -e /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.1000.1.0-gdb.py ']'
++++ basename /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.1000.1.0-gdb.py
+++ _la_symlink=/opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.1000.1.0-gdb.py
+++ _la_log '   _la_target: /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.1000.1.0-gdb.py'
+++ '[' '' = 1 ']'
+++ _la_log '  _la_symlink: /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.1000.1.0-gdb.py'
+++ '[' '' = 1 ']'
+++ '[' -L /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.1000.1.0-gdb.py ']'
++++ readlink /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.1000.1.0-gdb.py
+++ '[' /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.1000.1.0-gdb.py = /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.1000.1.0-gdb.py ']'
+++ _la_log 'symlink $_la_symlink already exists and points to $_la_target, skipping.'
+++ '[' '' = 1 ']'
+++ continue
+++ _la_log 'Libarrow activation complete.'
+++ '[' '' = 1 ']'
+++ unset _la_gdb_prefix
+++ unset _la_log
+++ unset _la_orig_install_dir
+++ unset _la_placeholder
+++ unset _la_symlink
+++ unset _la_symlink_dir
+++ unset _la_target
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/libglib_activate.sh
+++ export GSETTINGS_SCHEMA_DIR_CONDA_BACKUP=
+++ GSETTINGS_SCHEMA_DIR_CONDA_BACKUP=
+++ export GSETTINGS_SCHEMA_DIR=/opt/miniconda3/envs/testbed/share/glib-2.0/schemas
+++ GSETTINGS_SCHEMA_DIR=/opt/miniconda3/envs/testbed/share/glib-2.0/schemas
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh
+++ test -n ''
+++ xml_catalog_files_libxml2=
+++ XML_CATALOG_FILES=
+++ conda_catalog_files=
+++ ifs_libxml2=' 	
'
+++ IFS=' '
+++ rem=/opt/miniconda3/envs/testbed
+++ for pre in ${rem}
+++ test '' = /opt/miniconda3/envs/testbed
+++ conda_catalog_files=/opt/miniconda3/envs/testbed
+++ rem=
+++ IFS=' 	
'
+++ conda_catalog_files='file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ export 'XML_CATALOG_FILES=file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ XML_CATALOG_FILES='file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ unset conda_catalog_files ifs_libxml2 rem
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r
+ python -m pip install --no-deps -e .
Obtaining file:///testbed
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Checking if build backend supports build_editable: started
  Checking if build backend supports build_editable: finished with status 'done'
  Getting requirements to build editable: started
  Getting requirements to build editable: finished with status 'done'
  Preparing editable metadata (pyproject.toml): started
  Preparing editable metadata (pyproject.toml): finished with status 'done'
Building wheels for collected packages: dask
  Building editable for dask (pyproject.toml): started
  Building editable for dask (pyproject.toml): finished with status 'done'
  Created wheel for dask: filename=dask-2023.12.1+15.g6d5b994cb.dirty-0.editable-py3-none-any.whl size=6704 sha256=575a7a903841bb3b8792aeffc4df184ddaaa3918361aac78d30ed8f9e53be46d
  Stored in directory: /tmp/pip-ephem-wheel-cache-ejfx__fj/wheels/0d/a6/cb/465a7b303d624cc531250fa27c75d038ddc29430bdb6ba7c9f
Successfully built dask
Installing collected packages: dask
  Attempting uninstall: dask
    Found existing installation: dask 2023.12.1+15.g6d5b994cb
    Uninstalling dask-2023.12.1+15.g6d5b994cb:
      Successfully uninstalled dask-2023.12.1+15.g6d5b994cb
Successfully installed dask-2023.12.1+15.g6d5b994cb.dirty
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
+ git checkout 6d5b994cb58f295c27bd888de0f67c83ed568d3d dask/dataframe/tests/test_shuffle.py
Updated 0 paths from af9d05513
+ git apply -v -
Checking patch dask/dataframe/tests/test_shuffle.py...
Applied patch dask/dataframe/tests/test_shuffle.py cleanly.
+ pytest -n0 -rA --color=no dask/dataframe/tests/test_shuffle.py
============================= test session starts ==============================
platform linux -- Python 3.10.19, pytest-9.0.1, pluggy-1.6.0 -- /opt/miniconda3/envs/testbed/bin/python3.10
cachedir: .pytest_cache
rootdir: /testbed
configfile: pyproject.toml
plugins: rerunfailures-16.1, mimesis-18.0.0, xdist-3.8.0, timeout-2.4.0, cov-7.0.0
timeout: 300.0s
timeout method: thread
timeout func_only: False
collecting ... collected 286 items

dask/dataframe/tests/test_shuffle.py::test_shuffle[disk] PASSED          [  0%]
dask/dataframe/tests/test_shuffle.py::test_shuffle[tasks] PASSED         [  0%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_deprecated_shuffle_keyword[disk] PASSED [  1%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_deprecated_shuffle_keyword[tasks] PASSED [  1%]
dask/dataframe/tests/test_shuffle.py::test_default_partitions PASSED     [  1%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_npartitions[disk] PASSED [  2%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_npartitions[tasks] PASSED [  2%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_npartitions_lt_input_partitions[disk] PASSED [  2%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_npartitions_lt_input_partitions[tasks] PASSED [  3%]
dask/dataframe/tests/test_shuffle.py::test_index_with_non_series[disk] PASSED [  3%]
dask/dataframe/tests/test_shuffle.py::test_index_with_non_series[tasks] PASSED [  3%]
dask/dataframe/tests/test_shuffle.py::test_index_with_dataframe[disk] PASSED [  4%]
dask/dataframe/tests/test_shuffle.py::test_index_with_dataframe[tasks] PASSED [  4%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_from_one_partition_to_one_other[disk] PASSED [  4%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_from_one_partition_to_one_other[tasks] PASSED [  5%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_empty_partitions[disk] PASSED [  5%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_empty_partitions[tasks] PASSED [  5%]
dask/dataframe/tests/test_shuffle.py::test_partitioning_index PASSED     [  6%]
dask/dataframe/tests/test_shuffle.py::test_partitioning_index_categorical_on_values PASSED [  6%]
dask/dataframe/tests/test_shuffle.py::test_set_index_general[disk-1] PASSED [  6%]
dask/dataframe/tests/test_shuffle.py::test_set_index_general[disk-4] PASSED [  7%]
dask/dataframe/tests/test_shuffle.py::test_set_index_general[disk-7] PASSED [  7%]
dask/dataframe/tests/test_shuffle.py::test_set_index_general[disk-23] SKIPPED [  8%]
dask/dataframe/tests/test_shuffle.py::test_set_index_general[tasks-1] PASSED [  8%]
dask/dataframe/tests/test_shuffle.py::test_set_index_general[tasks-4] PASSED [  8%]
dask/dataframe/tests/test_shuffle.py::test_set_index_general[tasks-7] PASSED [  9%]
dask/dataframe/tests/test_shuffle.py::test_set_index_general[tasks-23] SKIPPED [  9%]
dask/dataframe/tests/test_shuffle.py::test_set_index_string[disk-string[python]] PASSED [  9%]
dask/dataframe/tests/test_shuffle.py::test_set_index_string[disk-string[pyarrow]] PASSED [ 10%]
dask/dataframe/tests/test_shuffle.py::test_set_index_string[disk-object] PASSED [ 10%]
dask/dataframe/tests/test_shuffle.py::test_set_index_string[tasks-string[python]] PASSED [ 10%]
dask/dataframe/tests/test_shuffle.py::test_set_index_string[tasks-string[pyarrow]] PASSED [ 11%]
dask/dataframe/tests/test_shuffle.py::test_set_index_string[tasks-object] PASSED [ 11%]
dask/dataframe/tests/test_shuffle.py::test_set_index_self_index[disk] PASSED [ 11%]
dask/dataframe/tests/test_shuffle.py::test_set_index_self_index[tasks] PASSED [ 12%]
dask/dataframe/tests/test_shuffle.py::test_set_index_names[disk] XFAIL   [ 12%]
dask/dataframe/tests/test_shuffle.py::test_set_index_names[tasks] PASSED [ 12%]
dask/dataframe/tests/test_shuffle.py::test_set_index_2[disk] PASSED      [ 13%]
dask/dataframe/tests/test_shuffle.py::test_set_index_2[tasks] PASSED     [ 13%]
dask/dataframe/tests/test_shuffle.py::test_set_index_3[disk] PASSED      [ 13%]
dask/dataframe/tests/test_shuffle.py::test_set_index_3[tasks] PASSED     [ 14%]
dask/dataframe/tests/test_shuffle.py::test_set_index_no_sort[True-True] PASSED [ 14%]
dask/dataframe/tests/test_shuffle.py::test_set_index_no_sort[True-False] PASSED [ 15%]
dask/dataframe/tests/test_shuffle.py::test_set_index_no_sort[False-True] PASSED [ 15%]
dask/dataframe/tests/test_shuffle.py::test_set_index_no_sort[False-False] PASSED [ 15%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_sort[disk] PASSED     [ 16%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_sort[tasks] PASSED    [ 16%]
dask/dataframe/tests/test_shuffle.py::test_rearrange[disk-threads] PASSED [ 16%]
dask/dataframe/tests/test_shuffle.py::test_rearrange[disk-processes] PASSED [ 17%]
dask/dataframe/tests/test_shuffle.py::test_rearrange[tasks-threads] PASSED [ 17%]
dask/dataframe/tests/test_shuffle.py::test_rearrange[tasks-processes] PASSED [ 17%]
dask/dataframe/tests/test_shuffle.py::test_rearrange_cleanup PASSED      [ 18%]
dask/dataframe/tests/test_shuffle.py::test_rearrange_disk_cleanup_with_exception PASSED [ 18%]
dask/dataframe/tests/test_shuffle.py::test_rearrange_by_column_with_narrow_divisions PASSED [ 18%]
dask/dataframe/tests/test_shuffle.py::test_maybe_buffered_partd PASSED   [ 19%]
dask/dataframe/tests/test_shuffle.py::test_set_index_with_explicit_divisions PASSED [ 19%]
dask/dataframe/tests/test_shuffle.py::test_set_index_with_empty_divisions PASSED [ 19%]
dask/dataframe/tests/test_shuffle.py::test_set_index_divisions_2 PASSED  [ 20%]
dask/dataframe/tests/test_shuffle.py::test_set_index_divisions_compute PASSED [ 20%]
dask/dataframe/tests/test_shuffle.py::test_set_index_divisions_sorted PASSED [ 20%]
dask/dataframe/tests/test_shuffle.py::test_set_index_consistent_divisions SKIPPED [ 21%]
dask/dataframe/tests/test_shuffle.py::test_npartitions_auto_raises_deprecation_warning FAILED [ 21%]
dask/dataframe/tests/test_shuffle.py::test_set_index_doesnt_increase_partitions[disk] PASSED [ 22%]
dask/dataframe/tests/test_shuffle.py::test_set_index_doesnt_increase_partitions[tasks] PASSED [ 22%]
dask/dataframe/tests/test_shuffle.py::test_set_index_detects_sorted_data[disk] PASSED [ 22%]
dask/dataframe/tests/test_shuffle.py::test_set_index_detects_sorted_data[tasks] PASSED [ 23%]
dask/dataframe/tests/test_shuffle.py::test_set_index_sorts PASSED        [ 23%]
dask/dataframe/tests/test_shuffle.py::test_set_index[pandas] PASSED      [ 23%]
dask/dataframe/tests/test_shuffle.py::test_set_index[cudf] SKIPPED (...) [ 24%]
dask/dataframe/tests/test_shuffle.py::test_set_index_deprecated_shuffle_keyword[disk] PASSED [ 24%]
dask/dataframe/tests/test_shuffle.py::test_set_index_deprecated_shuffle_keyword[tasks] PASSED [ 24%]
dask/dataframe/tests/test_shuffle.py::test_set_index_interpolate[pandas] PASSED [ 25%]
dask/dataframe/tests/test_shuffle.py::test_set_index_interpolate[cudf] SKIPPED [ 25%]
dask/dataframe/tests/test_shuffle.py::test_set_index_interpolate_int[pandas] PASSED [ 25%]
dask/dataframe/tests/test_shuffle.py::test_set_index_interpolate_int[cudf] SKIPPED [ 26%]
dask/dataframe/tests/test_shuffle.py::test_set_index_interpolate_large_uint[pandas] PASSED [ 26%]
dask/dataframe/tests/test_shuffle.py::test_set_index_interpolate_large_uint[cudf] SKIPPED [ 26%]
dask/dataframe/tests/test_shuffle.py::test_set_index_timezone PASSED     [ 27%]
dask/dataframe/tests/test_shuffle.py::test_set_index_npartitions PASSED  [ 27%]
dask/dataframe/tests/test_shuffle.py::test_set_index_datetime_precision[ns] PASSED [ 27%]
dask/dataframe/tests/test_shuffle.py::test_set_index_datetime_precision[us] PASSED [ 28%]
dask/dataframe/tests/test_shuffle.py::test_set_index_drop[True] PASSED   [ 28%]
dask/dataframe/tests/test_shuffle.py::test_set_index_drop[False] PASSED  [ 29%]
dask/dataframe/tests/test_shuffle.py::test_set_index_raises_error_on_bad_input PASSED [ 29%]
dask/dataframe/tests/test_shuffle.py::test_set_index_sorted_true PASSED  [ 29%]
dask/dataframe/tests/test_shuffle.py::test_set_index_sorted_single_partition PASSED [ 30%]
dask/dataframe/tests/test_shuffle.py::test_set_index_sorted_min_max_same PASSED [ 30%]
dask/dataframe/tests/test_shuffle.py::test_set_index_empty_partition PASSED [ 30%]
dask/dataframe/tests/test_shuffle.py::test_set_index_on_empty[int] PASSED [ 31%]
dask/dataframe/tests/test_shuffle.py::test_set_index_on_empty[float] PASSED [ 31%]
dask/dataframe/tests/test_shuffle.py::test_set_index_on_empty[str] PASSED [ 31%]
dask/dataframe/tests/test_shuffle.py::test_set_index_on_empty[<lambda>] PASSED [ 32%]
dask/dataframe/tests/test_shuffle.py::test_set_index_categorical PASSED  [ 32%]
dask/dataframe/tests/test_shuffle.py::test_set_index_with_empty_and_overlap PASSED [ 32%]
dask/dataframe/tests/test_shuffle.py::test_compute_divisions PASSED      [ 33%]
dask/dataframe/tests/test_shuffle.py::test_empty_partitions PASSED       [ 33%]
dask/dataframe/tests/test_shuffle.py::test_gh_2730 SKIPPED (need --r...) [ 33%]
dask/dataframe/tests/test_shuffle.py::test_set_index_does_not_repeat_work_due_to_optimizations PASSED [ 34%]
dask/dataframe/tests/test_shuffle.py::test_set_index_errors_with_inplace_kwarg PASSED [ 34%]
dask/dataframe/tests/test_shuffle.py::test_set_index_timestamp PASSED    [ 34%]
dask/dataframe/tests/test_shuffle.py::test_set_index_ea_dtype PASSED     [ 35%]
dask/dataframe/tests/test_shuffle.py::test_disk_shuffle_with_compression_option[None] PASSED [ 35%]
dask/dataframe/tests/test_shuffle.py::test_disk_shuffle_with_compression_option[ZLib] PASSED [ 36%]
dask/dataframe/tests/test_shuffle.py::test_disk_shuffle_with_unknown_compression[UNKOWN_COMPRESSION_ALGO] PASSED [ 36%]
dask/dataframe/tests/test_shuffle.py::test_disk_shuffle_check_actual_compression PASSED [ 36%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-id-None] PASSED [ 37%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-id-True] PASSED [ 37%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-id-False] PASSED [ 37%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-name-None] PASSED [ 38%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-name-True] PASSED [ 38%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-name-False] PASSED [ 38%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-on2-None] PASSED [ 39%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-on2-True] PASSED [ 39%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-on2-False] PASSED [ 39%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-on3-None] PASSED [ 40%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-on3-True] PASSED [ 40%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-on3-False] PASSED [ 40%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-id-None] PASSED [ 41%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-id-True] PASSED [ 41%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-id-False] PASSED [ 41%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-name-None] PASSED [ 42%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-name-True] PASSED [ 42%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-name-False] PASSED [ 43%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-on2-None] PASSED [ 43%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-on2-True] PASSED [ 43%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-on2-False] PASSED [ 44%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-on3-None] PASSED [ 44%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-on3-True] PASSED [ 44%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-on3-False] PASSED [ 45%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-id-None] PASSED [ 45%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-id-True] PASSED [ 45%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-id-False] PASSED [ 46%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-name-None] PASSED [ 46%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-name-True] PASSED [ 46%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-name-False] PASSED [ 47%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-on2-None] PASSED [ 47%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-on2-True] PASSED [ 47%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-on2-False] PASSED [ 48%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-on3-None] PASSED [ 48%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-on3-True] PASSED [ 48%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-on3-False] PASSED [ 49%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-id-None] PASSED [ 49%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-id-True] PASSED [ 50%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-id-False] PASSED [ 50%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-name-None] PASSED [ 50%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-name-True] PASSED [ 51%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-name-False] PASSED [ 51%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-on2-None] PASSED [ 51%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-on2-True] PASSED [ 52%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-on2-False] PASSED [ 52%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-on3-None] PASSED [ 52%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-on3-True] PASSED [ 53%]
dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-on3-False] PASSED [ 53%]
dask/dataframe/tests/test_shuffle.py::test_set_index_overlap PASSED      [ 53%]
dask/dataframe/tests/test_shuffle.py::test_set_index_overlap_2 PASSED    [ 54%]
dask/dataframe/tests/test_shuffle.py::test_set_index_overlap_does_not_drop_rows_when_divisions_overlap PASSED [ 54%]
dask/dataframe/tests/test_shuffle.py::test_compute_current_divisions_nan_partition PASSED [ 54%]
dask/dataframe/tests/test_shuffle.py::test_compute_current_divisions_overlap PASSED [ 55%]
dask/dataframe/tests/test_shuffle.py::test_compute_current_divisions_overlap_2 PASSED [ 55%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_hlg_layer PASSED      [ 55%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_partitions_meta_dtype PASSED [ 56%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_hlg_layer_serialize[10] PASSED [ 56%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_hlg_layer_serialize[1] PASSED [ 56%]
dask/dataframe/tests/test_shuffle.py::test_set_index_nan_partition PASSED [ 57%]
dask/dataframe/tests/test_shuffle.py::test_set_index_with_dask_dt_index PASSED [ 57%]
dask/dataframe/tests/test_shuffle.py::test_set_index_with_series_uses_fastpath PASSED [ 58%]
dask/dataframe/tests/test_shuffle.py::test_set_index_partitions_meta_dtype PASSED [ 58%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_partitions_meta_dtype_with_divisions PASSED [ 58%]
dask/dataframe/tests/test_shuffle.py::test_sort_values[10-a-True] PASSED [ 59%]
dask/dataframe/tests/test_shuffle.py::test_sort_values[10-a-False] PASSED [ 59%]
dask/dataframe/tests/test_shuffle.py::test_sort_values[10-b-True] PASSED [ 59%]
dask/dataframe/tests/test_shuffle.py::test_sort_values[10-b-False] PASSED [ 60%]
dask/dataframe/tests/test_shuffle.py::test_sort_values[10-by2-True] PASSED [ 60%]
dask/dataframe/tests/test_shuffle.py::test_sort_values[10-by2-False] PASSED [ 60%]
dask/dataframe/tests/test_shuffle.py::test_sort_values[500-a-True] PASSED [ 61%]
dask/dataframe/tests/test_shuffle.py::test_sort_values[500-a-False] PASSED [ 61%]
dask/dataframe/tests/test_shuffle.py::test_sort_values[500-b-True] PASSED [ 61%]
dask/dataframe/tests/test_shuffle.py::test_sort_values[500-b-False] PASSED [ 62%]
dask/dataframe/tests/test_shuffle.py::test_sort_values[500-by2-True] PASSED [ 62%]
dask/dataframe/tests/test_shuffle.py::test_sort_values[500-by2-False] PASSED [ 62%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_deprecated_shuffle_keyword[disk] PASSED [ 63%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_deprecated_shuffle_keyword[tasks] PASSED [ 63%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[True-x-pandas] PASSED [ 63%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[True-x-cudf] SKIPPED [ 64%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[True-z-pandas] PASSED [ 64%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[True-z-cudf] SKIPPED [ 65%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[True-by2-pandas] PASSED [ 65%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[True-by2-cudf] SKIPPED [ 65%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[True-by3-pandas] PASSED [ 66%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[True-by3-cudf] SKIPPED [ 66%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[False-x-pandas] PASSED [ 66%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[False-x-cudf] SKIPPED [ 67%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[False-z-pandas] PASSED [ 67%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[False-z-cudf] SKIPPED [ 67%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[False-by2-pandas] PASSED [ 68%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[False-by2-cudf] SKIPPED [ 68%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[False-by3-pandas] PASSED [ 68%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[False-by3-cudf] SKIPPED [ 69%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by0-True] PASSED [ 69%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by0-False] PASSED [ 69%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by0-ascending2] PASSED [ 70%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by0-ascending3] PASSED [ 70%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by1-True] PASSED [ 70%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by1-False] PASSED [ 71%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by1-ascending2] PASSED [ 71%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by1-ascending3] PASSED [ 72%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by0-True] PASSED [ 72%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by0-False] PASSED [ 72%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by0-ascending2] PASSED [ 73%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by0-ascending3] PASSED [ 73%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by1-True] PASSED [ 73%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by1-False] PASSED [ 74%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by1-ascending2] PASSED [ 74%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by1-ascending3] PASSED [ 74%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-a-True-first] PASSED [ 75%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-a-True-last] PASSED [ 75%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-a-False-first] PASSED [ 75%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-a-False-last] PASSED [ 76%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-b-True-first] PASSED [ 76%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-b-True-last] PASSED [ 76%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-b-False-first] PASSED [ 77%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-b-False-last] PASSED [ 77%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-by2-True-first] PASSED [ 77%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-by2-True-last] PASSED [ 78%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-by2-False-first] PASSED [ 78%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-by2-False-last] PASSED [ 79%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-a-True-first] PASSED [ 79%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-a-True-last] PASSED [ 79%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-a-False-first] PASSED [ 80%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-a-False-last] PASSED [ 80%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-b-True-first] PASSED [ 80%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-b-True-last] PASSED [ 81%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-b-False-first] PASSED [ 81%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-b-False-last] PASSED [ 81%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-by2-True-first] PASSED [ 82%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-by2-True-last] PASSED [ 82%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-by2-False-first] PASSED [ 82%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-by2-False-last] PASSED [ 83%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-a-True-first] PASSED [ 83%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-a-True-last] PASSED [ 83%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-a-False-first] PASSED [ 84%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-a-False-last] PASSED [ 84%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-b-True-first] PASSED [ 84%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-b-True-last] PASSED [ 85%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-b-False-first] PASSED [ 85%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-b-False-last] PASSED [ 86%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-by2-True-first] PASSED [ 86%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-by2-True-last] PASSED [ 86%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-by2-False-first] PASSED [ 87%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-by2-False-last] PASSED [ 87%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-a-True-first] PASSED [ 87%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-a-True-last] PASSED [ 88%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-a-False-first] PASSED [ 88%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-a-False-last] PASSED [ 88%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-b-True-first] PASSED [ 89%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-b-True-last] PASSED [ 89%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-b-False-first] PASSED [ 89%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-b-False-last] PASSED [ 90%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-by2-True-first] PASSED [ 90%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-by2-True-last] PASSED [ 90%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-by2-False-first] PASSED [ 91%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-by2-False-last] PASSED [ 91%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_values_raises PASSED  [ 91%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_by_as_list PASSED     [ 92%]
dask/dataframe/tests/test_shuffle.py::test_noop PASSED                   [ 92%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_custom_function[1-by0] PASSED [ 93%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_custom_function[1-by1] PASSED [ 93%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_custom_function[10-by0] PASSED [ 93%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_custom_function[10-by1] PASSED [ 94%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_bool_ascending PASSED [ 94%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_timestamp[1] PASSED [ 94%]
dask/dataframe/tests/test_shuffle.py::test_sort_values_timestamp[3] PASSED [ 95%]
dask/dataframe/tests/test_shuffle.py::test_calculate_divisions[pdf0-expected0] PASSED [ 95%]
dask/dataframe/tests/test_shuffle.py::test_calculate_divisions[pdf1-expected1] PASSED [ 95%]
dask/dataframe/tests/test_shuffle.py::test_calculate_divisions[pdf2-expected2] PASSED [ 96%]
dask/dataframe/tests/test_shuffle.py::test_set_index_pyarrow_dtype[data0-string[pyarrow]] SKIPPED [ 96%]
dask/dataframe/tests/test_shuffle.py::test_set_index_pyarrow_dtype[data1-binary[pyarrow]] SKIPPED [ 96%]
dask/dataframe/tests/test_shuffle.py::test_set_index_pyarrow_dtype[data2-int64[pyarrow]] SKIPPED [ 97%]
dask/dataframe/tests/test_shuffle.py::test_set_index_pyarrow_dtype[data3-float64[pyarrow]] SKIPPED [ 97%]
dask/dataframe/tests/test_shuffle.py::test_set_index_pyarrow_dtype[data4-uint64[pyarrow]] SKIPPED [ 97%]
dask/dataframe/tests/test_shuffle.py::test_set_index_pyarrow_dtype[data5-date32[pyarrow]] SKIPPED [ 98%]
dask/dataframe/tests/test_shuffle.py::test_set_index_pyarrow_dtype[data6-timestamp[ns][pyarrow]] SKIPPED [ 98%]
dask/dataframe/tests/test_shuffle.py::test_set_index_pyarrow_dtype[data7-decimal128] SKIPPED [ 98%]
dask/dataframe/tests/test_shuffle.py::test_set_index_pyarrow_dtype[data8-duration[ns][pyarrow]] SKIPPED [ 99%]
dask/dataframe/tests/test_shuffle.py::test_set_index_pyarrow_dtype[data9-time64[ns][pyarrow]] SKIPPED [ 99%]
dask/dataframe/tests/test_shuffle.py::test_shuffle_nulls_introduced PASSED [100%]

=================================== FAILURES ===================================
_______________ test_npartitions_auto_raises_deprecation_warning _______________

    def test_npartitions_auto_raises_deprecation_warning():
        df = pd.DataFrame({"x": range(100), "y": range(100)})
        ddf = dd.from_pandas(df, npartitions=10, name="x", sort=False)
        with pytest.raises(FutureWarning, match="npartitions='auto'"):
>           ddf.set_index("x", npartitions="auto")

dask/dataframe/tests/test_shuffle.py:580: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
dask/dataframe/core.py:5478: in set_index
    return set_index(
dask/utils.py:258: in wrapper
    return func(*args, **kwargs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

df = Dask DataFrame Structure:
                    x      y
npartitions=10              
                int64  int64
     ... ...
...               ...    ...
                  ...    ...
                  ...    ...
Dask Name: x, 1 graph layer
index = 'x', npartitions = 'auto', shuffle_method = None, compute = False
drop = True, upsample = 1.0, divisions = None, partition_size = 128000000.0
sort = True, kwargs = {}

    @_deprecated_kwarg("shuffle", "shuffle_method")
    def set_index(
        df: DataFrame,
        index: str | Series,
        npartitions: int | Literal["auto"] | None = None,
        shuffle_method: str | None = None,
        compute: bool = False,
        drop: bool = True,
        upsample: float = 1.0,
        divisions: Sequence | None = None,
        partition_size: float = 128e6,
        sort: bool = True,
        **kwargs,
    ) -> DataFrame:
        """See _Frame.set_index for docstring"""
        if not sort:
            return df.map_partitions(
                M.set_index, index, align_dataframes=False, drop=drop, **kwargs
            ).clear_divisions()
    
        if npartitions == "auto":
>           warnings.warn(
                "The 'auto' value for npartitions is deprecated and will be removed in a future version. "
                "Please specify an explicit number of partitions instead.",
                FutureWarning,
                stacklevel=2
            )
E           FutureWarning: The 'auto' value for npartitions is deprecated and will be removed in a future version. Please specify an explicit number of partitions instead.

dask/dataframe/shuffle.py:244: FutureWarning

During handling of the above exception, another exception occurred:

    def test_npartitions_auto_raises_deprecation_warning():
        df = pd.DataFrame({"x": range(100), "y": range(100)})
        ddf = dd.from_pandas(df, npartitions=10, name="x", sort=False)
>       with pytest.raises(FutureWarning, match="npartitions='auto'"):
E       AssertionError: Regex pattern did not match.
E         Expected regex: "npartitions='auto'"
E         Actual message: "The 'auto' value for npartitions is deprecated and will be removed in a future version. Please specify an explicit number of partitions instead."

dask/dataframe/tests/test_shuffle.py:579: AssertionError
=============================== warnings summary ===============================
dask/dataframe/tests/test_shuffle.py::test_shuffle_nulls_introduced
dask/dataframe/tests/test_shuffle.py::test_shuffle_nulls_introduced
  /opt/miniconda3/envs/testbed/lib/python3.10/site-packages/partd/pandas.py:214: FutureWarning: In a future version, object-dtype columns with all-bool values will not be included in reductions with bool_only=True. Explicitly cast to bool dtype instead.
    return pd.concat(dfs)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
==================================== PASSES ====================================
________________________ test_rearrange[disk-processes] ________________________
----------------------------- Captured stderr call -----------------------------
/testbed/dask/dataframe/_pyarrow_compat.py:23: UserWarning: You are using pyarrow version 10.0.1 which is known to be insecure. See https://www.cve.org/CVERecord?id=CVE-2023-47248 for further details. Please upgrade to pyarrow>=14.0.1 or install pyarrow-hotfix to patch your current version.
  warnings.warn(
/testbed/dask/dataframe/_pyarrow_compat.py:23: UserWarning: You are using pyarrow version 10.0.1 which is known to be insecure. See https://www.cve.org/CVERecord?id=CVE-2023-47248 for further details. Please upgrade to pyarrow>=14.0.1 or install pyarrow-hotfix to patch your current version.
  warnings.warn(
_______________________ test_rearrange[tasks-processes] ________________________
----------------------------- Captured stderr call -----------------------------
/testbed/dask/dataframe/_pyarrow_compat.py:23: UserWarning: You are using pyarrow version 10.0.1 which is known to be insecure. See https://www.cve.org/CVERecord?id=CVE-2023-47248 for further details. Please upgrade to pyarrow>=14.0.1 or install pyarrow-hotfix to patch your current version.
  warnings.warn(
/testbed/dask/dataframe/_pyarrow_compat.py:23: UserWarning: You are using pyarrow version 10.0.1 which is known to be insecure. See https://www.cve.org/CVERecord?id=CVE-2023-47248 for further details. Please upgrade to pyarrow>=14.0.1 or install pyarrow-hotfix to patch your current version.
  warnings.warn(
____________________________ test_rearrange_cleanup ____________________________
----------------------------- Captured stderr call -----------------------------
/testbed/dask/dataframe/_pyarrow_compat.py:23: UserWarning: You are using pyarrow version 10.0.1 which is known to be insecure. See https://www.cve.org/CVERecord?id=CVE-2023-47248 for further details. Please upgrade to pyarrow>=14.0.1 or install pyarrow-hotfix to patch your current version.
  warnings.warn(
__________________ test_rearrange_disk_cleanup_with_exception __________________
----------------------------- Captured stderr call -----------------------------
/testbed/dask/dataframe/_pyarrow_compat.py:23: UserWarning: You are using pyarrow version 10.0.1 which is known to be insecure. See https://www.cve.org/CVERecord?id=CVE-2023-47248 for further details. Please upgrade to pyarrow>=14.0.1 or install pyarrow-hotfix to patch your current version.
  warnings.warn(
============================= slowest 10 durations =============================
2.35s call     dask/dataframe/tests/test_shuffle.py::test_rearrange[tasks-processes]
2.21s call     dask/dataframe/tests/test_shuffle.py::test_rearrange[disk-processes]
1.36s call     dask/dataframe/tests/test_shuffle.py::test_rearrange_disk_cleanup_with_exception
1.33s call     dask/dataframe/tests/test_shuffle.py::test_set_index_general[disk-7]
1.18s call     dask/dataframe/tests/test_shuffle.py::test_rearrange_cleanup
0.82s call     dask/dataframe/tests/test_shuffle.py::test_set_index_general[disk-4]
0.79s call     dask/dataframe/tests/test_shuffle.py::test_set_index_general[tasks-7]
0.74s call     dask/dataframe/tests/test_shuffle.py::test_set_index_2[disk]
0.65s call     dask/dataframe/tests/test_shuffle.py::test_set_index_2[tasks]
0.58s call     dask/dataframe/tests/test_shuffle.py::test_set_index_drop[True]
=========================== short test summary info ============================
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_deprecated_shuffle_keyword[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_deprecated_shuffle_keyword[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_default_partitions
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_npartitions[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_npartitions[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_npartitions_lt_input_partitions[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_npartitions_lt_input_partitions[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_index_with_non_series[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_index_with_non_series[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_index_with_dataframe[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_index_with_dataframe[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_from_one_partition_to_one_other[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_from_one_partition_to_one_other[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_empty_partitions[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_empty_partitions[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_partitioning_index
PASSED dask/dataframe/tests/test_shuffle.py::test_partitioning_index_categorical_on_values
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_general[disk-1]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_general[disk-4]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_general[disk-7]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_general[tasks-1]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_general[tasks-4]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_general[tasks-7]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_string[disk-string[python]]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_string[disk-string[pyarrow]]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_string[disk-object]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_string[tasks-string[python]]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_string[tasks-string[pyarrow]]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_string[tasks-object]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_self_index[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_self_index[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_names[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_2[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_2[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_3[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_3[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_no_sort[True-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_no_sort[True-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_no_sort[False-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_no_sort[False-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_sort[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_sort[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_rearrange[disk-threads]
PASSED dask/dataframe/tests/test_shuffle.py::test_rearrange[disk-processes]
PASSED dask/dataframe/tests/test_shuffle.py::test_rearrange[tasks-threads]
PASSED dask/dataframe/tests/test_shuffle.py::test_rearrange[tasks-processes]
PASSED dask/dataframe/tests/test_shuffle.py::test_rearrange_cleanup
PASSED dask/dataframe/tests/test_shuffle.py::test_rearrange_disk_cleanup_with_exception
PASSED dask/dataframe/tests/test_shuffle.py::test_rearrange_by_column_with_narrow_divisions
PASSED dask/dataframe/tests/test_shuffle.py::test_maybe_buffered_partd
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_with_explicit_divisions
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_with_empty_divisions
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_divisions_2
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_divisions_compute
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_divisions_sorted
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_doesnt_increase_partitions[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_doesnt_increase_partitions[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_detects_sorted_data[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_detects_sorted_data[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_sorts
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index[pandas]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_deprecated_shuffle_keyword[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_deprecated_shuffle_keyword[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_interpolate[pandas]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_interpolate_int[pandas]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_interpolate_large_uint[pandas]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_timezone
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_npartitions
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_datetime_precision[ns]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_datetime_precision[us]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_drop[True]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_drop[False]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_raises_error_on_bad_input
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_sorted_true
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_sorted_single_partition
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_sorted_min_max_same
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_empty_partition
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_on_empty[int]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_on_empty[float]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_on_empty[str]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_on_empty[<lambda>]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_categorical
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_with_empty_and_overlap
PASSED dask/dataframe/tests/test_shuffle.py::test_compute_divisions
PASSED dask/dataframe/tests/test_shuffle.py::test_empty_partitions
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_does_not_repeat_work_due_to_optimizations
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_errors_with_inplace_kwarg
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_timestamp
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_ea_dtype
PASSED dask/dataframe/tests/test_shuffle.py::test_disk_shuffle_with_compression_option[None]
PASSED dask/dataframe/tests/test_shuffle.py::test_disk_shuffle_with_compression_option[ZLib]
PASSED dask/dataframe/tests/test_shuffle.py::test_disk_shuffle_with_unknown_compression[UNKOWN_COMPRESSION_ALGO]
PASSED dask/dataframe/tests/test_shuffle.py::test_disk_shuffle_check_actual_compression
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-id-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-id-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-id-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-name-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-name-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-name-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-on2-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-on2-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-on2-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-on3-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-on3-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-None-on3-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-id-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-id-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-id-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-name-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-name-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-name-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-on2-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-on2-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-on2-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-on3-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-on3-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[disk-4-on3-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-id-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-id-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-id-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-name-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-name-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-name-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-on2-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-on2-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-on2-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-on3-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-on3-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-None-on3-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-id-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-id-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-id-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-name-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-name-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-name-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-on2-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-on2-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-on2-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-on3-None]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-on3-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_dataframe_shuffle_on_arg[tasks-4-on3-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_overlap
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_overlap_2
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_overlap_does_not_drop_rows_when_divisions_overlap
PASSED dask/dataframe/tests/test_shuffle.py::test_compute_current_divisions_nan_partition
PASSED dask/dataframe/tests/test_shuffle.py::test_compute_current_divisions_overlap
PASSED dask/dataframe/tests/test_shuffle.py::test_compute_current_divisions_overlap_2
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_hlg_layer
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_partitions_meta_dtype
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_hlg_layer_serialize[10]
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_hlg_layer_serialize[1]
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_nan_partition
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_with_dask_dt_index
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_with_series_uses_fastpath
PASSED dask/dataframe/tests/test_shuffle.py::test_set_index_partitions_meta_dtype
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_partitions_meta_dtype_with_divisions
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values[10-a-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values[10-a-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values[10-b-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values[10-b-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values[10-by2-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values[10-by2-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values[500-a-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values[500-a-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values[500-b-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values[500-b-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values[500-by2-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values[500-by2-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_deprecated_shuffle_keyword[disk]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_deprecated_shuffle_keyword[tasks]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[True-x-pandas]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[True-z-pandas]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[True-by2-pandas]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[True-by3-pandas]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[False-x-pandas]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[False-z-pandas]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[False-by2-pandas]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_tasks_backend[False-by3-pandas]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by0-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by0-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by0-ascending2]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by0-ascending3]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by1-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by1-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by1-ascending2]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[10-by1-ascending3]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by0-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by0-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by0-ascending2]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by0-ascending3]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by1-True]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by1-False]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by1-ascending2]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_single_partition[500-by1-ascending3]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-a-True-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-a-True-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-a-False-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-a-False-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-b-True-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-b-True-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-b-False-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-b-False-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-by2-True-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-by2-True-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-by2-False-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-1-by2-False-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-a-True-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-a-True-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-a-False-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-a-False-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-b-True-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-b-True-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-b-False-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-b-False-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-by2-True-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-by2-True-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-by2-False-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data0-5-by2-False-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-a-True-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-a-True-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-a-False-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-a-False-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-b-True-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-b-True-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-b-False-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-b-False-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-by2-True-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-by2-True-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-by2-False-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-1-by2-False-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-a-True-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-a-True-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-a-False-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-a-False-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-b-True-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-b-True-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-b-False-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-b-False-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-by2-True-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-by2-True-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-by2-False-first]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_with_nulls[data1-5-by2-False-last]
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_values_raises
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_by_as_list
PASSED dask/dataframe/tests/test_shuffle.py::test_noop
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_custom_function[1-by0]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_custom_function[1-by1]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_custom_function[10-by0]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_custom_function[10-by1]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_bool_ascending
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_timestamp[1]
PASSED dask/dataframe/tests/test_shuffle.py::test_sort_values_timestamp[3]
PASSED dask/dataframe/tests/test_shuffle.py::test_calculate_divisions[pdf0-expected0]
PASSED dask/dataframe/tests/test_shuffle.py::test_calculate_divisions[pdf1-expected1]
PASSED dask/dataframe/tests/test_shuffle.py::test_calculate_divisions[pdf2-expected2]
PASSED dask/dataframe/tests/test_shuffle.py::test_shuffle_nulls_introduced
SKIPPED [4] conftest.py:65: need --runslow option to run
SKIPPED [1] dask/dataframe/tests/test_shuffle.py:693: could not import 'dask_cudf': No module named 'dask_cudf'
SKIPPED [1] dask/dataframe/tests/test_shuffle.py:749: could not import 'cudf': No module named 'cudf'
SKIPPED [1] dask/dataframe/tests/test_shuffle.py:778: could not import 'cudf': No module named 'cudf'
SKIPPED [1] dask/dataframe/tests/test_shuffle.py:802: could not import 'cudf': No module named 'cudf'
SKIPPED [8] dask/dataframe/tests/test_shuffle.py:1534: could not import 'dask_cudf': No module named 'dask_cudf'
SKIPPED [10] dask/dataframe/tests/test_shuffle.py:1713: dtype support not good before 2.0
XFAIL dask/dataframe/tests/test_shuffle.py::test_set_index_names[disk] - dsk names in disk shuffle are not deterministic
FAILED dask/dataframe/tests/test_shuffle.py::test_npartitions_auto_raises_deprecation_warning
====== 1 failed, 258 passed, 26 skipped, 1 xfailed, 2 warnings in 42.95s =======
+ git checkout 6d5b994cb58f295c27bd888de0f67c83ed568d3d dask/dataframe/tests/test_shuffle.py
Updated 1 path from af9d05513
